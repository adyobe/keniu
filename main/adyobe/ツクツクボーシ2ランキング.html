<!DOCTYPE html>
<html lang="ja">

<head>
  <script>console.log("(・ὢ・)見たな....")</script>
  <!-- LINE Tag Base Code -->
  <!-- Do Not Modify -->
  <script>
      (function (g, d, o) {
        g._ltq = g._ltq || []; g._lt = g._lt || function () { g._ltq.push(arguments) };
        var h = location.protocol === 'https:' ? 'https://d.line-scdn.net' : 'http://d.line-cdn.net';
        var s = d.createElement('script'); s.async = 1;
        s.src = o || h + '/n/line_tag/public/release/v1/lt.js';
        var t = d.getElementsByTagName('script')[0]; t.parentNode.insertBefore(s, t);
      })(window, document);
    _lt('init', {
      customerType: 'account',
      tagId: '31e6eaa0-0503-4711-9940-9716a1439ba6'
    });
    _lt('send', 'pv', ['31e6eaa0-0503-4711-9940-9716a1439ba6']);
  </script>
  <noscript>
    <img height="1" width="1" style="display:none" src="https://tr.line.me/tag.gif?c_t=lap&t_id=31e6eaa0-0503-4711-9940-9716a1439ba6&e=pv&noscript=1" />
  </noscript>
  <!-- End LINE Tag Base Code -->
  <script>
    _lt('send', 'cv', {
      type: 'Conversion'
    }, ['31e6eaa0-0503-4711-9940-9716a1439ba6']);
  </script>
  <title>ツクツクボーシ2ランキング</title>
  <meta charset="utf-8">
  <meta name="author" content="アヂョベ">
  <meta name="description" content="やあ">
  <meta name="keywords" content="ツクツクボーシ">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">
  <style>
    body {
      background-color: white;
      font-family: 'YuGothic', 'Yu Gothic', 'Hiragino Kaku Gothic ProN', 'ヒラギノ角ゴ ProN W3', 'メイリオ', 'Meiryo', 'ＭＳ ゴシック', sans-serif;
    }

    header {
      position: sticky;
      position: -webkit-sticky;
      top: 0;
      flex-wrap: wrap;
      background-color: white;
    }

    .rank {
      display: inline-block;
      width: 4rem;
    }

    main div span:not(.rank) {
      padding: 0 .5rem 0 1rem;
    }

    .com {
      text-indent: .5rem;
    }

    .comment {
      overflow: auto;
    }
  </style>
</head>

<body>
  <header>
    <div><a href="./%E3%83%84%E3%82%AF%E3%83%84%E3%82%AF%E3%83%9C%E3%83%BC%E3%82%B72.html">ツクツクボーシ2</a>ランキング</div>
    <div><button onclick="get()">再取得</button> 前回[<span id="getdate"></span>]</div>
  </header>
  <main>
    <div>
      <div id="r1">
        <div><span class="rank">第1位</span><span class="value"></span>日<span class="date"></span></div>
        <div class="com">名前:<span class="name"></span></div>
        <div class="com">・<span class="comment"></span></div>
      </div>
      <div id="r2">
        <div><span class="rank">第2位</span><span class="value"></span>日<span class="date"></span></div>
        <div class="com">名前:<span class="name"></span></div>
        <div class="com">・<span class="comment"></span></div>
      </div>
      <div id="r3">
        <div><span class="rank">第3位</span><span class="value"></span>日<span class="date"></span></div>
        <div class="com">名前:<span class="name"></span></div>
        <div class="com">・<span class="comment"></span></div>
      </div>
      <div id="r4">
        <div><span class="rank">第4位</span><span class="value"></span>日<span class="date"></span></div>
        <div class="com">名前:<span class="name"></span></div>
        <div class="com">・<span class="comment"></span></div>
      </div>
      <div id="r5">
        <div><span class="rank">第5位</span><span class="value"></span>日<span class="date"></span></div>
        <div class="com">名前:<span class="name"></span></div>
        <div class="com">・<span class="comment"></span></div>
      </div>
      <div id="r6">
        <div><span class="rank">第6位</span><span class="value"></span>日<span class="date"></span></div>
        <div class="com">名前:<span class="name"></span></div>
        <div class="com">・<span class="comment"></span></div>
      </div>
      <div id="r7">
        <div><span class="rank">第7位</span><span class="value"></span>日<span class="date"></span></div>
        <div class="com">名前:<span class="name"></span></div>
        <div class="com">・<span class="comment"></span></div>
      </div>
      <div id="r8">
        <div><span class="rank">第8位</span><span class="value"></span>日<span class="date"></span></div>
        <div class="com"><span class="name"></span></div>
        <div class="com">・<span class="comment"></span></div>
      </div>
      <div id="r9">
        <div><span class="rank">第9位</span><span class="value"></span>日<span class="date"></span></div>
        <div class="com">名前:<span class="name"></span></div>
        <div class="com">・<span class="comment"></span></div>
      </div>
      <div id="r10">
        <div><span class="rank">第10位</span><span class="value"></span>日<span class="date"></span></div>
        <div class="com">名前:<span class="name"></span></div>
        <div class="com">・<span class="comment"></span></div>
      </div>
    </div>
  </main>
  <br><br><br>
  <footer>
    <aside>
      <section>
        <h1>参考資料</h1>
        <ul>
          <li>
            <a href="https://twitter.com/windymelt/status/1424087366872956928">https://twitter.com/windymelt/status/1424087366872956928</a>
          </li>
        </ul>
      </section>
    </aside>
  </footer>

  <script>
    const url = "https://script.google.com/macros/s/AKfycbyxQsVtQkFt3dVThTHdwB9UftlhBHL7ySqXPih4mHxB7_bxE0s0VwN3LFsKe6EQIaGQ/exec";
    let r = []
    for (let i = 0; i < 10; i++) {
      r.push({
        name: document.querySelector("#r" + (i + 1) + " .name"),
        date: document.querySelector("#r" + (i + 1) + " .date"),
        value: document.querySelector("#r" + (i + 1) + " .value"),
        comment: document.querySelector("#r" + (i + 1) + " .comment"),
      })
    }
    const getdate = document.getElementById("getdate");
    const get = () => {
      let date = new Date()
      getdate.innerHTML = ("0" + date.getHours()).slice(-2) + ":" + ("0" + date.getMinutes()).slice(-2) + ":" + ("0" + date.getSeconds()).slice(-2) + "." + date.getMilliseconds();
      fetch(url).then(response => {
        console.log(response);
        return response.text();
      }).then(text => {
        text = JSON.parse(text);
        console.log(text);
        for (let i = 0; i < 10; i++) {
          r[i].name.innerHTML = text[i].name;
          r[i].date.innerHTML = text[i].date;
          r[i].value.innerHTML = text[i].value;
          r[i].comment.innerHTML = text[i].comment;
        }
      }).catch(error => {
        console.log(error);
        alert(error);
      });
    };
    window.addEventListener("load", get);
  </script>
</body>

</html>