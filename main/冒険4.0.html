<!DOCTYPE html>
<html lang="ja">

<head>
  <script>console.log("(・ὢ・)見たな....")</script>
  <!-- LINE Tag Base Code -->
  <!-- Do Not Modify -->
  <script>
      (function (g, d, o) {
        g._ltq = g._ltq || []; g._lt = g._lt || function () { g._ltq.push(arguments) };
        var h = location.protocol === 'https:' ? 'https://d.line-scdn.net' : 'http://d.line-cdn.net';
        var s = d.createElement('script'); s.async = 1;
        s.src = o || h + '/n/line_tag/public/release/v1/lt.js';
        var t = d.getElementsByTagName('script')[0]; t.parentNode.insertBefore(s, t);
      })(window, document);
    _lt('init', {
      customerType: 'account',
      tagId: '31e6eaa0-0503-4711-9940-9716a1439ba6'
    });
    _lt('send', 'pv', ['31e6eaa0-0503-4711-9940-9716a1439ba6']);
  </script>
  <noscript>
    <img height="1" width="1" style="display:none" src="https://tr.line.me/tag.gif?c_t=lap&t_id=31e6eaa0-0503-4711-9940-9716a1439ba6&e=pv&noscript=1" />
  </noscript>
  <!-- End LINE Tag Base Code -->
  <script>
    _lt('send', 'cv', {
      type: 'Conversion'
    }, ['31e6eaa0-0503-4711-9940-9716a1439ba6']);
  </script>

  <title>冒険4.0</title>
  <meta charset="utf-8">
  <meta name="author" content="アヂョベ">
  <meta name="description" content="やあ">
  <meta name="keywords" content="本と箱の庭,冒険シリーズ,冒険,ああああ,勇者,ゆうしゃ,ユウシャ">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">
  <link rel="icon" href="../assets/svg/book.svg">
  <link rel="stylesheet" href="../assets/css/all_class_date.css">
  <link rel="stylesheet" href="../assets/css/details_class_description.css">
  <style>
    details[open].description summary+div {
      color: var(--color);
      border-color: var(--color);
      background-color: var(--background-color);
    }

    details.description summary {
      border-color: var(--color);
    }
  </style>
  <style>
    *.darkmode {
      --background-color: #111;
      --color: #eee;
      --mode-text: "darkmode";
      --game-bottun-color-percent: 20%;
    }

    *.lightmode {
      /* 反転させるときは逆を指定 */
      --background-color: #eee;
      --color: #111;
      --mode-text: "lightmode";
      --game-bottun-color-percent: 60%;
    }

    *[data-text]::before {
      white-space: pre;
      content: attr(data-text);
    }

    *[data-text-after]::after {
      white-space: pre;
      content: attr(data-text-after);
    }

    *.mode-text::before {
      content: var(--mode-text);
    }

    @keyframes fadeIn {
      0% {
        opacity: 0;
        visibility: hidden;
        transform: translateY(-3px);
      }

      50% {
        transform: none;
      }

      100% {
        opacity: 1;
        visibility: visible;
      }
    }

    .fadeIn {
      animation: fadeIn .5s forwards;
    }

    @keyframes fadeOut {

      0% {
        opacity: 1;
        visibility: visible;
      }

      50% {
        transform: none;
      }

      100% {
        opacity: 0;
        visibility: hidden;
        transform: translateY(-3px);
      }
    }

    .fadeOut {
      animation: fadeIn .5s forwards;
    }

    @keyframes fadeInOut {
      0% {
        opacity: 0;
        visibility: hidden;
        transform: translateY(-3px);
      }

      12.5% {
        opacity: 1;
        visibility: visible;
      }

      25% {
        transform: none;
      }

      87.5% {
        opacity: 1;
        visibility: visible;
      }

      100% {
        opacity: 0;
        visibility: hidden;
      }
    }

    .container {
      white-space: nowrap;
    }

    .container>* {
      display: inline-block;
      vertical-align: middle;
    }

    #message {
      white-space: pre;
      overflow: auto;
    }

    #message.vo {
      visibility: hidden;
      opacity: 0;
    }

    #message.show {
      animation: fadeInOut 2s;
    }

    header {
      background: var(--color);
      color: var(--background-color);
      padding-bottom: 8px;
      transition: .5s;
      position: sticky;
      top: 0;
      flex-wrap: wrap;
      z-index: 1;
    }

    header>*:not(:first-child) {
      margin: 0px 8px;
    }

    header>*:nth-child(2) {
      margin-top: 8px;
    }

    body {
      font-family: 'YuGothic', 'Yu Gothic', 'Hiragino Kaku Gothic ProN', 'ヒラギノ角ゴ ProN W3', 'メイリオ', 'Meiryo', 'ＭＳ ゴシック', sans-serif;
      margin: 0;
      background: var(--background-color);
      color: var(--color);
      transition: .5s;
    }

    main {
      margin: 8px;
    }

    .mode-change {
      border: 2px solid var(--background-color);
      border-radius: 8px;
      padding: 0 2px;
      cursor: pointer;
      width: 5rem;
      text-align: center;
    }

    .none {
      display: none;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      margin: auto;
    }

    textarea {
      resize: none;
    }



    .game-button {
      color: white;
      background-color: blue;
      background: linear-gradient(to bottom, cyan, var(--game-bottun-color-percent), blue);
      --margin: 32px;
      margin: var(--margin) auto;
      border-radius: 4px;
      padding: 16px;
      text-align: center;
      vertical-align: middle;
      max-width: calc(100% - var(--margin) * 2);
      box-sizing: border-box;
      box-shadow: inset -4px -4px 2px rgba(0, 0, 119, 0.8), inset 4px 4px 2px rgba(173, 216, 250, 0.8);
      border: 4px solid var(--color);
      font-size: xx-large;
      text-shadow: 3px 3px 6px darkblue;
      cursor: pointer;
    }

    @keyframes fadeOut {
      0% {
        opacity: 1;
        visibility: visible;
      }

      100% {
        opacity: 0;
        visibility: hidden;
      }
    }

    .fadeOut {
      animation: fadeOut .5s forwards;
    }

    #archive>* {
      padding-left: 1rem;
      text-indent: -1rem;
      white-space: pre-wrap;
    }

    #learnedMagicList label {
      cursor: pointer;
    }

    #learnedMagicList button {
      cursor: pointer;
    }

    #learnedMagicList span {
      display: inline-block;
    }

    #learnedMagicList .magicSelect+span {
      width: 4rem;
      text-align: center;
    }

    #learnedMagicList .magicSelect:checked+span::before {
      content: "選択中";
    }

    #learnedMagicList>*>*>button:nth-child(4),
    #learnedMagicList>*>*>button:nth-child(6) {
      width: 1.5rem;
    }

    #learnedMagicList>*>*>span:nth-child(3) {
      width: 5rem;
    }

    #learnedMagicList>*>*>span:nth-child(5) {
      width: 2rem;
      text-align: end;
    }

    #learnedMagicList>*>*>div:nth-child(7) {
      padding-left: 1rem;
    }

    .sideSelectMagic {
      font-size: 0;
    }

    .sideSelectMagic>* {
      width: calc(100% / 3);
      font-size: initial;
      display: inline-block;
      box-sizing: border-box;
      max-width: 20rem;
    }

    .sideSelectMagic label {
      display: inline-block;
      width: 100%;
      box-sizing: border-box;
    }

    .sideStatus>* {
      width: calc(100% / 3);
      font-size: initial;
      display: inline-block;
      box-sizing: border-box;
    }

    .sideStatus {
      font-size: 0;
    }

    #enemyImg {
      object-fit: contain;
      width: 50vw;
    }

    .img50 {
      object-fit: contain;
      width: 50vw;
    }
  </style>
  <script>
    let userID = (() => {
      let number = "";
      for (let i = 0; i < 8; i++) {
        number += Math.floor(Math.random() * 10).toString();
      }
      return number;
    })()
  </script>
</head>

<body class="lightmode">
  <noscript style="color: red; font: bold; font-size: 30vw;">Javascriptを有効にしてください</noscript>
  <div id="open" style="display: none;">
    <header>
      <div class="date"></div>
      <div class="container">
        <div class="mode-text mode-change" onclick="modeChange(darkmodeOn = !darkmodeOn);"></div>
        <div><button onclick="share()" data-text="共有"></button></div>
        <div>
          <span data-text="表示選択" onclick="menu(this.parentElement.querySelector('select'));"></span>
          <select name="menuSelect" onchange="menu(this)">
            <option value="mainPage">メイン</option>
            <option value="magicPage" class="menu1 none">魔法選択</option>
            <option value="itemPage" class="menu1 none">アイテム</option>
            <option value="pointPage" class="menu1 none">ポイント</option>
            <option value="settingPage">設定</option>
            <option value="indexPage">図鑑</option>
            <option value="logPage">履歴</option>
          </select>
        </div>
      </div>
      <div id="message">冒険4.0</div>
    </header>
    <main>
      <div id="mainPage">
        <div>
          <div class="game-button" onclick="start(this);"><span data-text="start"></span></div>
          <div>
            <br>
            <div><button onclick="load(document.getElementById('loaddataTextarea').value);this.parentElement.parentElement.classList.add('none')">loadする</button></div>
            <div><textarea id="loaddataTextarea" style="width: 100%;box-sizing: border-box;" rows="3"></textarea></div>
          </div>
        </div>
        <div id="start" style="display: none;">
          <div><span style="font-style: italic;">識別番号:<span class="userID"></span></span></div>
          <div>現在：<span class="nowPosition">0</span>階</div>
          <div id="goBackButton">
            <div><button onclick="goBack(1)">進む</button><button onclick="goBack(-1)">戻る</button><button onclick="goBack(-position)">0階まで戻る</button></div>
          </div>
          <div id="goBackPosition" class="none">
            <div id="enemy">
              <div class="sideStatus">
                <div><span class="name">hehe</span></div>
                <div>HP:<span class="hp">100</span></div>
                <div>MP:<span class="mp">100</span></div>
              </div>
            </div>
            <img id="enemyImg" src="../assets/svg/book.svg" alt="enemy">
            <div class="sideSelectMagic">
              <div><label><span class="selectMagic1">木</span><input type="radio" name="onMagic" checked></label></div>
              <div><label><span class="selectMagic2">火</span><input type="radio" name="onMagic"></label></div>
            </div>
            <div id="player">
              <div class="sideStatus">
                <div><span class="name">you</span></div>
                <div>HP:<span class="hp">100</span></div>
                <div>MP:<span class="mp">100</span></div>
              </div>
            </div>
            <div><button onclick="onMagic()">発動</button></div>
            <section>
              <h1>現在の装備</h1>
              <div>1つ目の装備:<span class="selectItem1">お守り</span></div>
              <div>2つ目の装備:<span class="selectItem2">なし</span></div>
            </section>
            <div><button onclick="goBackMenu();goBack(-position)">0階まで戻る</button></div>
            <section>
              <h1>行動履歴</h1>
              <div id="actionResult"></div>
            </section>
          </div>
        </div>
      </div>
      <div id="magicPage">
        <section>
          <h1>magicPage</h1>
          <section>
            <h2>選択中の魔法</h2>
            <div class="selectMagic1">木</div>
            <div class="selectMagic2">火</div>
          </section>
          <section>
            <h2>習得済み魔法</h2>
            <div><button onclick="learnedMagicListPageChange(-1)">前のページ</button><button onclick="learnedMagicListPageChange(1)">次のページ</button><span data-text=" " class="learnedMagicListPageNumber"></span></div>
            <div>現在のポイント<span data-text=" " class="nowPoint"></span></div>
            <form id="learnedMagicList" onsubmit="return false" onchange="setMagicChange(event.target)">
              <div class="learnedMagicListPage">
                <div><label><input type="radio" name="magic1" class="magicSelect" checked><span></span></label><label><input type="radio" name="magic2" class="magicSelect"><span></span></label><span>木</span><button onclick="magicPointChangeSub(1,this)">+</button><span>0</span><button onclick="magicPointChangeSub(-1,this)">-</button></div>
                <div><label><input type="radio" name="magic1" class="magicSelect"><span></span></label><label><input type="radio" name="magic2" class="magicSelect" checked><span></span></label><span>火</span><button onclick="magicPointChangeSub(1,this)">+</button><span>0</span><button onclick="magicPointChangeSub(-1,this)">-</button></div>
                <div><label><input type="radio" name="magic1" class="magicSelect"><span></span></label><label><input type="radio" name="magic2" class="magicSelect"><span></span></label><span>土</span><button onclick="magicPointChangeSub(1,this)">+</button><span>0</span><button onclick="magicPointChangeSub(-1,this)">-</button></div>
                <div><label><input type="radio" name="magic1" class="magicSelect"><span></span></label><label><input type="radio" name="magic2" class="magicSelect"><span></span></label><span>金</span><button onclick="magicPointChangeSub(1,this)">+</button><span>0</span><button onclick="magicPointChangeSub(-1,this)">-</button></div>
                <div><label><input type="radio" name="magic1" class="magicSelect"><span></span></label><label><input type="radio" name="magic2" class="magicSelect"><span></span></label><span>水</span><button onclick="magicPointChangeSub(1,this)">+</button><span>0</span><button onclick="magicPointChangeSub(-1,this)">-</button></div>
              </div>
              <div class="learnedMagicListPage">
                <div><label><input type="radio" name="magic1" class="magicSelect"><span></span></label><label><input type="radio" name="magic2" class="magicSelect"><span></span></label><span>木偶</span><button onclick="magicPointChangeSub(1,this)">+</button><span>0</span><button onclick="magicPointChangeSub(-1,this)">-</button></div>
                <div><label><input type="radio" name="magic1" class="magicSelect"><span></span></label><label><input type="radio" name="magic2" class="magicSelect"><span></span></label><span>火炎</span><button onclick="magicPointChangeSub(1,this)">+</button><span>0</span><button onclick="magicPointChangeSub(-1,this)">-</button></div>
                <div><label><input type="radio" name="magic1" class="magicSelect"><span></span></label><label><input type="radio" name="magic2" class="magicSelect"><span></span></label><span>土壁</span><button onclick="magicPointChangeSub(1,this)">+</button><span>0</span><button onclick="magicPointChangeSub(-1,this)">-</button></div>
                <div><label><input type="radio" name="magic1" class="magicSelect"><span></span></label><label><input type="radio" name="magic2" class="magicSelect"><span></span></label><span>金環</span><button onclick="magicPointChangeSub(1,this)">+</button><span>0</span><button onclick="magicPointChangeSub(-1,this)">-</button></div>
                <div><label><input type="radio" name="magic1" class="magicSelect"><span></span></label><label><input type="radio" name="magic2" class="magicSelect"><span></span></label><span>水氷</span><button onclick="magicPointChangeSub(1,this)">+</button><span>0</span><button onclick="magicPointChangeSub(-1,this)">-</button></div>
              </div>
              <div class="learnedMagicListPage">
                <div><label><input type="radio" name="magic1" class="magicSelect"><span></span></label><label><input type="radio" name="magic2" class="magicSelect"><span></span></label><span>旋風</span><button onclick="magicPointChangeSub(1,this)">+</button><span>0</span><button onclick="magicPointChangeSub(-1,this)">-</button></div>
                <div><label><input type="radio" name="magic1" class="magicSelect"><span></span></label><label><input type="radio" name="magic2" class="magicSelect"><span></span></label><span>炎天</span><button onclick="magicPointChangeSub(1,this)">+</button><span>0</span><button onclick="magicPointChangeSub(-1,this)">-</button></div>
                <div><label><input type="radio" name="magic1" class="magicSelect"><span></span></label><label><input type="radio" name="magic2" class="magicSelect"><span></span></label><span>山鳴</span><button onclick="magicPointChangeSub(1,this)">+</button><span>0</span><button onclick="magicPointChangeSub(-1,this)">-</button></div>
                <div><label><input type="radio" name="magic1" class="magicSelect"><span></span></label><label><input type="radio" name="magic2" class="magicSelect"><span></span></label><span>電石</span><button onclick="magicPointChangeSub(1,this)">+</button><span>0</span><button onclick="magicPointChangeSub(-1,this)">-</button></div>
                <div><label><input type="radio" name="magic1" class="magicSelect"><span></span></label><label><input type="radio" name="magic2" class="magicSelect"><span></span></label><span>滴下</span><button onclick="magicPointChangeSub(1,this)">+</button><span>0</span><button onclick="magicPointChangeSub(-1,this)">-</button></div>
              </div>
            </form>
          </section>
        </section>
      </div>
      <div id="itemPage">
        <section>
          <h1>アイテム欄</h1>
          <div id="nowItem">
            <div>1つ目の装備:<span class="selectItem1">お守り</span></div>
            <div>2つ目の装備:<span class="selectItem2">なし</span></div>
          </div>
          <br>
          <div id="armorSelect"><button onclick="armorListChange(1)">1つ目の装備を選ぶ</button><button id="armor2" onclick="armorListChange(2)">2つ目の装備を選ぶ</button></div>
          <div id="armorList" class="none">
            <div data-item="none"><button onclick="armorChange(this)">戻る</button></div>
            <div data-item="Amulet"><button onclick="armorChange(this)">お守り</button></div>
            <div data-item="Salt"><button onclick="armorChange(this)">塩を送らず</button></div>
            <div data-item="Guts"><button onclick="armorChange(this)">根性</button></div>
            <div data-item="Schoolbag"><button onclick="armorChange(this)">ランドセル</button></div>
            <div data-item="Oakwand"><button onclick="armorChange(this)">樫の杖</button></div>
            <div data-item="Skandashoes"><button onclick="armorChange(this)">韋駄天の靴</button></div>
            <div data-item="Talisman"><button onclick="armorChange(this)">祝福のベル</button></div>
            <div data-item="Charm"><button onclick="armorChange(this)">トリップトリック</button></div>
          </div>
        </section>
      </div>
      <div id="pointPage">
        <section>
          <h1>pointPage</h1>
          <section>
            <h2>未習得の魔法</h2>
            <div>残りポイント<span data-text=" " class="nowPoint"></span></div>
            <div id="unlearnedMagicList">
              <div>必要ポイント <span>30 5階に到達する</span></div>
              <div><button onclick="learn()" disabled>次の魔法を習得する</button></div>
            </div>
            <details class="description">
              <summary>魔法の説明</summary>
              <div>
                <section>
                  <h1>1つ目の魔法</h1>
                  <div>最初に覚えている魔法。</div>
                </section>
                <section>
                  <h1>2つ目の魔法</h1>
                  <div>中間に位置する魔法。</div>
                </section>
                <section>
                  <h1>3つ目の魔法</h1>
                  <div>最後に覚える魔法。</div>
                </section>
              </div>
            </details>
          </section>
          <section id="itemBuyList">
            <h2>アイテム購入</h2>
            <div>必要ポイント 5</div>
            <p data-item="Amulet">所持数<span data-text="[" data-text-after="]"></span><button onclick="armorBuy(this)">お守り</button></p>
            <p data-item="Salt">所持数<span data-text="[" data-text-after="]"></span><button onclick="armorBuy(this)">塩を送らず</button></p>
            <div>必要ポイント 10 黄スライムを5体帰す</div>
            <p data-item="Guts">所持数<span data-text="[" data-text-after="]"></span><button onclick="armorBuy(this)" disabled>根性</button></p>
            <p data-item="Schoolbag">所持数<span data-text="[" data-text-after="]"></span><button onclick="armorBuy(this)" disabled>ランドセル</button></p>
            <div>必要ポイント 15 白スライムを1体帰す</div>
            <p data-item="Oakwand">所持数<span data-text="[" data-text-after="]"></span><button onclick="armorBuy(this)" disabled>樫の杖</button></p>
            <p data-item="Skandashoes">所持数<span data-text="[" data-text-after="]"></span><button onclick="armorBuy(this)" disabled>韋駄天の靴</button></p>
            <div>必要ポイント 20 黒スライムを1体帰す</div>
            <p data-item="Talisman">所持数<span data-text="[" data-text-after="]"></span><button onclick="armorBuy(this)" disabled>祝福のベル</button></p>
            <p data-item="Charm">所持数<span data-text="[" data-text-after="]"></span><button onclick="armorBuy(this)" disabled>トリップトリック</button></p>
            <details class="description">
              <summary>アイテムの説明</summary>
              <div>
                <ul>
                  <li>
                    <section>
                      <h1>お守り</h1>
                      <div>hpが負傷するとき、その量を3減らす。ただし最小で1までしか減らせない。</div>
                    </section>
                  </li>
                  <li>
                    <section>
                      <h1>塩を送らず</h1>
                      <div>相手によって自身のhpまたはmpが回復される、もしくは自身によって相手のhpまたはmpが回復されるとき、それを無効化する。</div>
                    </section>
                  </li>
                  <li>
                    <section>
                      <h1>根性</h1>
                      <div>hpが2割以上残っている状態から0まで減りそうになったとき、hpが0にならず1だけ残る。</div>
                    </section>
                  </li>
                  <li>
                    <section>
                      <h1>ランドセル</h1>
                      <div>行動後にhpとmpが5ずつ回復する。</div>
                    </section>
                  </li>
                  <li>
                    <section>
                      <h1>樫の杖</h1>
                      <div>全ての魔法の威力が5だけ上がる。</div>
                    </section>
                  </li>
                  <li>
                    <section>
                      <h1>韋駄天の靴</h1>
                      <div>稀に1回多く行動する。相手の行動回数には影響しない。</div>
                    </section>
                  </li>
                  <li>
                    <section>
                      <h1>祝福のベル</h1>
                      <div>hpが0になったとき、稀にhpとmpが全快する。</div>
                    </section>
                  </li>
                  <li>
                    <section>
                      <h1>トリップトリック</h1>
                      <div>自身に起因したあらゆる行動の確率を上昇させる。</div>
                    </section>
                  </li>
                </ul>
              </div>
            </details>
          </section>
        </section>
      </div>
      <div id="settingPage">
        <aside>
          <h1>設定</h1>
          <section>
            <h2>あなたの情報</h2>
            <div>userID: <span class="userID"></span></div>
            <div><button onclick="userIDset(this.parentElement.querySelector('input'));">変更</button><span data-text=" "></span><input type="number" id="userIDinput" min="10000000" max="99999999"></div>
            <div>savedataを<input type="button" value="取得する" onclick="savedataValue(document.getElementById('savedataTextarea'), document.getElementById('savedataTextareaDate'))"><span data-text=" ">前回:</span><span id="savedataTextareaDate"></span></div>
            <div><textarea id="savedataTextarea" style="width: 100%;box-sizing: border-box;" rows="3"></textarea></div>
            <div>現在は<span class="JSmodeText"></span>です。</div>
            <div>所持しているポイントは<span class="nowPoint">0</span>ポイントです。</div>
            <div>現在の階層は<span class="nowPosition">0</span>階です。</div>
            <div>最大到達階層は<span class="bestPosition">0</span>階です。</div>
          </section>
        </aside>
      </div>
      <div id="indexPage">
        <section>
          <h1>図鑑</h1>
          <details class="description">
            <summary>魔法の説明</summary>
            <div>
              <section>
                <h1>魔法の特性</h1>
                <div>
                  <ul>
                    <li>
                      <section>
                        <h2>木属性 特殊</h2>
                        <div>特殊な攻撃が多い</div>
                      </section>
                    </li>
                    <li>
                      <section>
                        <h2>火属性 攻撃</h2>
                        <div>総じて火力が高い</div>
                      </section>
                    </li>
                    <li>
                      <section>
                        <h2>土属性 防御</h2>
                        <div>他より防御に特化</div>
                      </section>
                    </li>
                    <li>
                      <section>
                        <h2>金属性 回復</h2>
                        <div>回復に優れている</div>
                      </section>
                    </li>
                    <li>
                      <section>
                        <h2>水属性 異常</h2>
                        <div>状態異常を起こす</div>
                      </section>
                    </li>
                  </ul>
                </div>
              </section>
              <section>
                <h1>1つ目の魔法</h1>
                <div>
                  <ul>
                    <li>
                      <section>
                        <h2>木</h2>
                        <div>mp0 少し攻撃 使用後mpを少し回復</div>
                      </section>
                    </li>
                    <li>
                      <section>
                        <h2>火</h2>
                        <div>mp2 攻撃 稀にやけどを負わせる 稀に会心</div>
                      </section>
                    </li>
                    <li>
                      <section>
                        <h2>土</h2>
                        <div>mp2 少し攻撃 次の攻撃を軽減</div>
                      </section>
                    </li>
                    <li>
                      <section>
                        <h2>金</h2>
                        <div>mp1 hpを少し回復</div>
                      </section>
                    </li>
                    <li>
                      <section>
                        <h2>水</h2>
                        <div>mp3 少し攻撃 相手を稀にひるませる</div>
                      </section>
                    </li>
                  </ul>
                </div>
              </section>
              <section>
                <h1>2つ目の魔法</h1>
                <div>
                  <ul>
                    <li>
                      <section>
                        <h2>木偶</h2>
                        <div>mp0 自他ともにhpとmpを減少させる hp,mpは0までしか減らない</div>
                      </section>
                    </li>
                    <li>
                      <section>
                        <h2>火炎</h2>
                        <div>mp4 2回攻撃 稀にやけどを負わせる 稀に会心</div>
                      </section>
                    </li>
                    <li>
                      <section>
                        <h2>土壁</h2>
                        <div>mp4 次の攻撃を受け流す</div>
                      </section>
                    </li>
                    <li>
                      <section>
                        <h2>金環</h2>
                        <div>mp3 hpと状態異常を回復</div>
                      </section>
                    </li>
                    <li>
                      <section>
                        <h2>水氷</h2>
                        <div>mp9 相手のhpを現状から2割減少させ続ける</div>
                      </section>
                    </li>
                  </ul>
                </div>
              </section>
              <section>
                <h1>3つ目の魔法</h1>
                <div>
                  <ul>
                    <li>
                      <section>
                        <h2>旋風</h2>
                        <div>mp1 少し攻撃 稀に自身の行動を増加 稀に会心 稀にmpを回復 稀にhpを回復</div>
                      </section>
                    </li>
                    <li>
                      <section>
                        <h2>炎天</h2>
                        <div>mp10 強い3回攻撃 稀にやけどを負わせる 常に会心 稀にmp回復 次の威力+2</div>
                      </section>
                    </li>
                    <li>
                      <section>
                        <h2>山鳴</h2>
                        <div>mp10 次の攻撃を9割減少 次状態異常を受けにくい hpを回復</div>
                      </section>
                    </li>
                    <li>
                      <section>
                        <h2>電石</h2>
                        <div>mp7 hpを半分回復 状態異常を回復 次状態異常を受けにくい 次の攻撃に反撃する</div>
                      </section>
                    </li>
                    <li>
                      <section>
                        <h2>滴下</h2>
                        <div>hp10 hpを消費して攻撃 与えた負傷の半分のmpを回復 稀に会心 次状態異常を受けやすい</div>
                      </section>
                    </li>
                  </ul>
                </div>
              </section>
            </div>
          </details>
          <details class="description">
            <summary>用語の説明</summary>
            <div>
              <section>
                <h1>バフ</h1>
                <ul>
                  <li>
                    <section>
                      <h2>defense</h2>
                      <div>防御。土の魔法を使うことで効果を得る。次の相手の行動時に自身のhpが負傷するとき、その量を2割減少させる。</div>
                    </section>
                  </li>
                  <li>
                    <section>
                      <h2>parry</h2>
                      <div>受け流し。土壁の魔法を使うことで効果を得る。次の相手の行動時に自身のhpが負傷するとき、その量を5割減少させ、かつその量の2倍で攻撃する。</div>
                    </section>
                  </li>
                  <li>
                    <section>
                      <h2>boost</h2>
                      <div>強化。炎天の魔法を使うことで効果を得る。次の自身の行動時に全ての魔法の威力を+2する。</div>
                    </section>
                  </li>
                  <li>
                    <section>
                      <h2>Sdefense</h2>
                      <div>超防御。山鳴の魔法を使うことで効果を得る。次の相手の行動時に自身のhpが負傷するとき、その量を9割減少させる。</div>
                    </section>
                  </li>
                  <li>
                    <section>
                      <h2>healthy</h2>
                      <div>健康的。山鳴の魔法や電石の魔法を使うことで効果を得る。次の相手の行動時に自身へデバフがかけられるとき、その継続時間を減少させる。</div>
                    </section>
                  </li>
                  <li>
                    <section>
                      <h2>counter</h2>
                      <div>反撃。電石の魔法を使うことで効果を得る。次の相手の行動時に自身のhpが負傷するとき、その量を4割減少させ、かつその量の半分で攻撃する。</div>
                    </section>
                  </li>
                </ul>
              </section>
              <section>
                <h1>デバフ</h1>
                <ul>
                  <li>
                    <section>
                      <h2>burn</h2>
                      <div>やけど。火属性の魔法を使われることで効果を得る。一定回数までの行動後に自身のhpが一定量ずつ減る。</div>
                    </section>
                  </li>
                  <li>
                    <section>
                      <h2>falter</h2>
                      <div>怯み。水の魔法を使われることで効果を得る。次の自身の行動時に全ての魔法の威力を-2する。</div>
                    </section>
                  </li>
                  <li>
                    <section>
                      <h2>curse</h2>
                      <div>呪い。水氷の魔法を使われることで効果を得る。一定回数までの行動後に自身のhpが現状から2割ずつ減る。</div>
                    </section>
                  </li>
                  <li>
                    <section>
                      <h2>unhealthy</h2>
                      <div>不健康。滴下の魔法を使うことで効果を得る。次の相手の行動時に自身へデバフがかけられるとき、その継続時間を増加させる。</div>
                    </section>
                  </li>
                </ul>
              </section>
            </div>
          </details>
          <details class="description">
            <summary>アイテムの説明</summary>
            <div>
              <ul>
                <li>
                  <section>
                    <h1>お守り</h1>
                    <div>hpが負傷するとき、その量を3減らす。ただし最小で1までしか減らせない。</div>
                  </section>
                </li>
                <li>
                  <section>
                    <h1>塩を送らず</h1>
                    <div>相手によって自身のhpまたはmpが回復される、もしくは自身によって相手のhpまたはmpが回復されるとき、それを無効化する。</div>
                  </section>
                </li>
                <li>
                  <section>
                    <h1>根性</h1>
                    <div>hpが2割以上残っている状態から0まで減りそうになったとき、hpが0にならず1だけ残る。</div>
                  </section>
                </li>
                <li>
                  <section>
                    <h1>ランドセル</h1>
                    <div>行動後にhpとmpが5ずつ回復する。</div>
                  </section>
                </li>
                <li>
                  <section>
                    <h1>樫の杖</h1>
                    <div>全ての魔法の威力が5だけ上がる。</div>
                  </section>
                </li>
                <li>
                  <section>
                    <h1>韋駄天の靴</h1>
                    <div>稀に1回多く行動する。相手の行動回数には影響しない。</div>
                  </section>
                </li>
                <li>
                  <section>
                    <h1>祝福のベル</h1>
                    <div>hpが0になったとき、稀にhpとmpが全快する。</div>
                  </section>
                </li>
                <li>
                  <section>
                    <h1>トリップトリック</h1>
                    <div>自身に起因したあらゆる行動の確率を上昇させる。</div>
                  </section>
                </li>
              </ul>
            </div>
          </details>
          <details class="description">
            <summary>敵の説明</summary>
            <div>
              <ul>
                <li>
                  <section>
                    <h1>青スライム</h1>
                    <img class="img50" src="../assets/svg/blueSlime.svg" alt="青スライムの画像">
                    <div>hp:100 mp:100 魔法威力0 ポイント2</div>
                    <div>木の魔法をよく使うが、hpが減ってくると稀に金の魔法を使う。</div>
                  </section>
                </li>
                <li>
                  <section>
                    <h1>赤スライム</h1>
                    <img class="img50" src="../assets/svg/redSlime.svg" alt="赤スライムの画像">
                    <div>hp:300 mp:300 魔法威力2 ポイント3</div>
                    <div>火属性の魔法を全て使える。しかし世間を舐めているので、普段は火の魔法しか使わない。hpが50を切り、命の危機を感じてようやく上位の魔法を使い始める。</div>
                  </section>
                </li>
                <li>
                  <section>
                    <h1>黄スライム</h1>
                    <img class="img50" src="../assets/svg/yellowSlime.svg" alt="黄スライムの画像">
                    <div>hp:100 mp:100 魔法威力3 ポイント5</div>
                    <div>水、火炎、土壁、金環、水氷の魔法をランダムに放つ。魔法をたくさん使えるようにはなったが、mpは成長しなかったのですぐ枯渇する。</div>
                  </section>
                </li>
                <li>
                  <section>
                    <h1>白スライム</h1>
                    <img class="img50" src="../assets/svg/whiteSlime.svg" alt="白スライムの画像">
                    <div>hp:500 mp:500 魔法威力5 ポイント10</div>
                    <div>旋風の魔法を使う。hpが減ってくると段階的に使う魔法の種類を増やしてくる。山鳴や電石の他、滴下の魔法も使うらしい。</div>
                  </section>
                </li>
                <li>
                  <section>
                    <h1>黒スライム</h1>
                    <img class="img50" src="../assets/svg/blackSlime.svg" alt="黒スライムの画像">
                    <div>hp:1000 mp:1000 魔法威力5 ポイント20</div>
                    <div>強いスライム。炎天の魔法や旋風の魔法を使うが、炎天の魔法の方が好みで少し多く使うらしい。稀に威力25の水氷の魔法を使ってくる。</div>
                  </section>
                </li>
              </ul>
            </div>
          </details>
        </section>
      </div>
      <div id="logPage">
        <section>
          <h1>履歴一覧</h1>
          <div id="archive"></div>
        </section>
      </div>
    </main>
  </div>

  <script src="../assets/js/all_class_date.js"></script>
  <script>
    // 環境
    document.getElementById("open").outerHTML = document.getElementById("open").innerHTML;
    let darkmodeOn = window.matchMedia("(prefers-color-scheme: dark)").matches;
    const modeChange = (boolean = darkmodeOn) => {
      if (boolean) {
        document.body.classList.remove("lightmode");
        document.body.classList.add("darkmode");
        for (const i of document.getElementsByClassName("JSmodeText")) {
          i.innerText = "darkmode";
        }
      } else {
        document.body.classList.remove("darkmode");
        document.body.classList.add("lightmode");
        for (const i of document.getElementsByClassName("JSmodeText")) {
          i.innerText = "lightmode";
        }
      }
    };
    let messageText = [];
    let messageOn = true;
    const messageElement = document.getElementById("message");
    messageElement.addEventListener("animationend", () => {
      messageElement.classList.remove("show");
      messageElement.classList.add("vo");
      messageText.shift();
      messageOn = true;
      setTimeout(() => {
        if (messageText.length > 0) {
          messageElement.textContent = "";
        } else {
          messageElement.innerText = "冒険4.0";
          messageElement.classList.remove("vo");
        }
        messageSay();
      }, 0);
    });
    const archive = text => {
      let div = document.createElement("div");
      div.innerHTML = document.getElementsByClassName("date")[0].innerText + "：" + text;
      document.getElementById("archive").insertAdjacentElement("afterbegin", div);
    };
    const messageSay = (text, arc = true) => {
      if (typeof text !== "undefined") {
        text = text.toString();
        if (/\S/.test(text)) {
          messageText.push(text);
          if (arc) {
            archive(messageText[messageText.length - 1]);
          }
        }
      }
      if (messageOn && messageText.length > 0) {
        messageElement.innerHTML = messageText[0].replaceAll("\n", " ");
        messageOn = false;
        messageElement.classList.add("show");
      }
    };
    const share = () => {
      save();
      let shareData = {
        title: document.title,
        text: "",
        url: location.href.replace(location.search, "") + "?d=" + savedata,
      };
      if ("navigator" in window && "share" in window.navigator) {
        window.navigator.share(shareData).then(() => {
          setTimeout(() => {
            messageSay("共有に成功しました。");
          }, 0);
        }).catch((err) => {
          setTimeout(() => {
            messageSay(err + "のため失敗。");
          }, 0);
        });
      } else {
        messageSay("共有に対応していません。");
      }
    };
    const elementGetSize = {
      // list: "・All\n ┣ height\n ┗ width\n・height\n・width\n・padding\n ┣ height\n ┗ width\n・border\n・margin\n ┣ height\n ┗ width",
      All: {
        height: (element = document.body) => {
          let i = element.getBoundingClientRect().height;
          i += parseFloat(window.getComputedStyle(element).marginTop);
          i += parseFloat(window.getComputedStyle(element).marginBottom);
          return i + "px";
        },
        width: (element = document.body) => {
          let i = element.getBoundingClientRect().width;
          i += parseFloat(window.getComputedStyle(element).marginLeft);
          i += parseFloat(window.getComputedStyle(element).marginRight);
          return i + "px";
        },
      },
      font: (element = document.body) => {
        let i = window.getComputedStyle(element).fontSize;
        return i + "px";
      },
      height: (element = document.body) => {
        let i = element.getBoundingClientRect().height;
        return i + "px";
      },
      width: (element = document.body) => {
        let i = element.getBoundingClientRect().width;
        return i + "px";
      },
      padding: {
        all: (element = document.body) => {
          return window.getComputedStyle(element).padding;
        },
        height: (element = document.body) => {
          let i = parseFloat(window.getComputedStyle(element).paddingTop);
          i += parseFloat(window.getComputedStyle(element).paddingBottom);
          return i + "px";
        },
        width: (element = document.body) => {
          let i = parseFloat(window.getComputedStyle(element).paddingLeft);
          i += parseFloat(window.getComputedStyle(element).paddingRight);
          return i + "px";
        },
      },
      border: (element = document.body) => {
        let i = parseFloat(window.getComputedStyle(element).borderWidth);
        return i + "px";
      },
      margin: {
        all: (element = document.body) => {
          return window.getComputedStyle(element).margin;
        },
        height: (element = document.body) => {
          let i = parseFloat(window.getComputedStyle(element).marginTop);
          i += parseFloat(window.getComputedStyle(element).marginBottom);
          return i + "px";
        },
        width: (element = document.body) => {
          let i = parseFloat(window.getComputedStyle(element).marginLeft);
          i += parseFloat(window.getComputedStyle(element).marginRight);
          return i + "px";
        },
      },
    }
    const elementSetSize = {
      font: (element = document.body, px = false) => {
        if (px !== false) {
          element.style.fontSize = parseFloat(px) + "px";
        } else {
          element.style.removeProperty("font-size");
        }
      },
      height: (element = document.body, px = false) => {
        if (px !== false) {
          element.style.height = parseFloat(px) + "px";
        } else {
          element.style.removeProperty("height");
        }
      },
      width: (element = document.body, px = false) => {
        if (px !== false) {
          element.style.width = parseFloat(px) + "px";
        } else {
          element.style.removeProperty("width");
        }
      },
      padding: {
        all: (element = document.body, px = false) => {
          if (px !== false) {
            element.style.padding = parseFloat(px) + "px";
          } else {
            element.style.removeProperty("padding");
          }
        },
        height: (element = document.body, px = false) => {
          if (px !== false) {
            element.style.paddingTop = parseFloat(px) + "px";
            element.style.paddingBottom = parseFloat(px) + "px";
          } else {
            element.style.removeProperty("paddingTop");
            element.style.removeProperty("paddingBottom");
          }
        },
        width: (element = document.body, px = false) => {
          if (px !== false) {
            element.style.paddingLeft = parseFloat(px) + "px";
            element.style.paddingRight = parseFloat(px) + "px";
          } else {
            element.style.removeProperty("paddingLeft");
            element.style.removeProperty("paddingRight");
          }
        },
      },
      border: (element = document.body, px = false) => {
        if (px !== false) {
          element.style.borderWidth = parseFloat(px) + "px";
        } else {
          element.style.removeProperty("borderWidth");
        }
      },
      margin: {
        all: (element = document.body, px = false) => {
          if (px !== false) {
            element.style.margin = parseFloat(px) + "px";
          } else {
            element.style.removeProperty("margin");
          }
        },
        height: (element = document.body, px = false) => {
          if (px !== false) {
            element.style.marginTop = parseFloat(px) + "px";
            element.style.marginBottom = parseFloat(px) + "px";
          } else {
            element.style.removeProperty("marginTop");
            element.style.removeProperty("marginBottom");
          }
        },
        width: (element = document.body, px = false) => {
          if (px !== false) {
            element.style.marginLeft = parseFloat(px) + "px";
            element.style.marginRight = parseFloat(px) + "px";
          } else {
            element.style.removeProperty("marginLeft");
            element.style.removeProperty("marginRight");
          }
        },
      },
    };
    const elementReSize = (element = document.body, percent = 0) => {
      let size = Math.max(percent / 100, 0);
      elementSetSize.font(element, parseFloat(elementGetSize.font(element)) * size);
      elementSetSize.height(element, parseFloat(elementGetSize.height(element)) * size);
      elementSetSize.width(element, parseFloat(elementGetSize.width(element)) * size);
      elementSetSize.padding.height(element, parseFloat(elementGetSize.padding.height(element)) * size / 2);
      elementSetSize.padding.width(element, parseFloat(elementGetSize.padding.width(element)) * size / 2);
      elementSetSize.border(element, parseFloat(elementGetSize.border(element)) * size);
      elementSetSize.margin.height(element, parseFloat(elementGetSize.margin.height(element)) * size / 2);
      // elementSetSize.margin.width(element, parseFloat(elementGetSize.margin.width(element)) * size / 2);
    };
    const elementFadeOut = (element = document.body, answer = () => { console.log(clone); }, time = 50, clone, n = 0) => {
      if (typeof clone === "undefined") {
        clone = document.importNode(element, true);
      }
      if (time < 1) time = Math.max(time, 1);
      if (n++ < time) {
        elementReSize(element, 95 + 5 * n / time);
        setTimeout(() => {
          elementFadeOut(element, answer, time, clone, n);
        }, 1);
      } else {
        element.style.display = "none";
        try {
          answer(element, answer, time, clone, n);
        } catch (error) {
          console.log(error);
        }
      }
    }

    // 最後に実行
    modeChange();




    // Game sub
    let learnedMagicListPageNow = 0;
    let learnedMagicListPageLength = 1;
    const learnedMagicListPageAll =
      document.getElementsByClassName("learnedMagicListPage");
    const learnedMagicListPageNumber = document.getElementsByClassName("learnedMagicListPageNumber");
    let magicPoint = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,];
    const magicQuery = document.querySelectorAll("#learnedMagicList>div>div");
    const selectMagic1 = document.getElementsByClassName("selectMagic1");
    const selectMagic2 = document.getElementsByClassName("selectMagic2");
    const selectItem1 = document.getElementsByClassName("selectItem1");
    const selectItem2 = document.getElementsByClassName("selectItem2");
    const goBackButton = document.getElementById("goBackButton");
    const goBackPosition = document.getElementById("goBackPosition");
    const actionResult = document.getElementById("actionResult");
    const enemyImg = document.getElementById("enemyImg");

    const messageSet = {
      achievement: (text = "none") => {
        messageSay("実績【" + text + "】", false);
        archive("実績【" + text + "】を獲得しました。");
        return [text, "実績【" + text + "】", "実績【" + text + "】を獲得しました。"];
      },
      announce: {
        menu: (text = "none") => {
          messageSay("表示選択に" + text + "が追加されます。", false);
          archive("<お知らせ>表示選択から" + text + "が選べるようになりました。");
          return [text, "表示選択に" + text + "が追加されます。", "<お知らせ>表示選択から" + text + "が選べるようになりました。"];
        },
      },
      point: (number = 0, text = "報酬として") => {
        number = deleteNotNumber(number);
        if (number != 0) {
          messageSay(number + "ポイント獲得", false);
          archive(text + number + "ポイント獲得しました。");
          return [number, number + "ポイント獲得しました。", text + number + "ポイント獲得"];
        }
      },
      action: (text = "none") => {
        // archive("[行動]" + text);
        let div = document.createElement("div");
        div.innerText = text;
        actionResult.insertAdjacentElement("afterbegin", div);
      },
    };
    const userIDchange = (id = userID, change = true) => {
      beforeID = userID;
      id = id.replaceAll(/\D/g, "");
      if (userID != id && id.length == 8) {
        userID = id;
        for (const i of document.getElementsByClassName("userID")) {
          i.innerHTML = userID;
        };
        if (change) {
          messageSay("userID: " + userID, false);
          archive("\nユーザーIDが" + beforeID + "から\n[<span style='font-style: italic;' data-text='　' data-text-after='　'>" + userID + "</span>]になりました。");
        }
      }
    };
    const fadeInOnce = element => {
      element.classList.remove("none");
      element.classList.add("fadeIn");
      setTimeout(() => {
        element.classList.remove("fadeIn");
      }, 500);
    };
    const fadeOutOnce = element => {
      element.classList.add("fadeOut");
      setTimeout(() => {
        element.classList.add("none");
        element.classList.remove("fadeOut");
      }, 500);
    };
    const savedataValue = (elementValue, elementDate) => {
      save();
      if (typeof elementDate !== "undefined") {
        elementDate.innerHTML = document.getElementsByClassName("date")[0].innerText;
      }
      elementValue.value = savedata;
      messageSay("セーブデータを出力しました。");
    };
    const learnedMagicListPageChange = (plus = 1) => {
      plus = plus % learnedMagicListPageLength + learnedMagicListPageLength;
      learnedMagicListPageNow = (learnedMagicListPageNow + plus) % learnedMagicListPageLength;
      for (let i = 0; i < learnedMagicListPageAll.length; i++) {
        if (i == learnedMagicListPageNow) {
          learnedMagicListPageAll[i].classList.remove("none");
        } else {
          learnedMagicListPageAll[i].classList.add("none");
        }
      }
      for (const i of learnedMagicListPageNumber) {
        i.innerText = learnedMagicListPageNow + 1;
      }
    };

    // 最後に実行
    for (const i of document.getElementsByClassName("userID")) {
      i.innerHTML = userID;
    };
    document.getElementById("userIDinput").value = userID;
    archive("ユーザーIDは\n[<span style='font-style: italic;' data-text='　' data-text-after='　'>" + userID + "</span>]です。");
    learnedMagicListPageChange(0);



    // status
    let status = {
      player: {
        normal: {
          name: "player",
          hp: 100,
          mp: 100,
        },
        battle: {
          id: "normal",
          name: "player",
          hp: 100,
          mp: 100,
          buff: {
            burn: 0, //やけど
            defense: 0, //防御
            falter: 0, //怯み
            parry: 0, //受け流し
            curse: 0, //呪い
            boost: 0, //増強
            Sdefense: 0, //超防御
            healthy: 0, //状態異常効かない
            counter: 0, //反撃
            unhealthy: 0, //状態異常効きやすい
          },
        },
        none: {
          name: "エラー",
          hp: 1,
          mp: 1,
        },
        item: {
          first: "Amulet",
          second: "none",
          has: {
            none: 2,
            Amulet: 0,
            Salt: 0,
            Guts: 0,
            Schoolbag: 0,
            Oakwand: 0,
            Skandashoes: 0,
            Talisman: 0,
            Charm: 0,
          },
          all: {
            Amulet: 1,
            Salt: 0,
            Guts: 0,
            Schoolbag: 0,
            Oakwand: 0,
            Skandashoes: 0,
            Talisman: 0,
            Charm: 0,
          },
        },
      },
      enemy: {
        battle: {
          id: "blueSlime",
          name: "青スライム",
          hp: 100,
          mp: 100,
          buff: {
            burn: 0, //やけど
            defense: 0, //防御
            falter: 0, //怯み
            parry: 0, //受け流し
            curse: 0, //呪い
            boost: 0, //増強
            Sdefense: 0, //超防御
            healthy: 0, //状態異常効かない
            counter: 0, //反撃
            unhealthy: 0, //状態異常効きやすい
          },
        },
        none: {
          name: "エラー",
          hp: 1,
          mp: 1,
        },
        blueSlime:
        {
          name: "青スライム",
          hp: 100,
          mp: 100,
          xp: 2,
          magic: (plus = 0) => {
            let ep = plus;
            let em = magic.list[0];
            if (status.enemy.battle.hp < 50) {
              if (Math.floor(Math.random() * 10) < 3) {
                em = magic.list[3];
              }
            }
            return [ep, em];
          },
          count: 0,
          after: () => {
            status.enemy.blueSlime.count++;
          },
          img: "../assets/svg/blueSlime.svg",
        },
        redSlime: {
          name: "赤スライム",
          hp: 200,
          mp: 300,
          xp: 3,
          magic: (plus = 0) => {
            let ep = 2 + plus;
            let em = magic.list[1];
            if (status.enemy.battle.hp < 50) {
              if (Math.floor(Math.random() * 10) < 3) {
                ep += 1;
                em = magic.list[6];
                if (Math.floor(Math.random() * 10) < 3) {
                  ep += 2;
                  em = magic.list[11];
                }
              }
            }
            return [ep, em];
          },
          count: 0,
          after: () => {
            status.enemy.redSlime.count++;
          },
          img: "../assets/svg/redSlime.svg",
        },
        yellowSlime: {
          name: "黄スライム",
          hp: 100,
          mp: 100,
          xp: 5,
          magic: (plus = 0) => {
            let ep = 3 + plus;
            let em = magic.list[4];
            switch (Math.floor(Math.random() * 5)) {
              case 0:
                break;
              case 1:
                em = magic.list[6];
                break;
              case 2:
                em = magic.list[7];
                break;
              case 3:
                em = magic.list[8];
                break;
              case 4:
                em = magic.list[9];
                break;
            }
            return [ep, em];
          },
          count: 0,
          after: () => {
            status.enemy.yellowSlime.count++;
            if (status.enemy.yellowSlime.count == 5) {
              document.getElementById("itemBuyList").querySelector("*[data-item=Guts]>button").disabled = false;
              document.getElementById("itemBuyList").querySelector("*[data-item=Schoolbag]>button").disabled = false;
            }
          },
          img: "../assets/svg/yellowSlime.svg",
        },
        whiteSlime: {
          name: "白スライム",
          hp: 500,
          mp: 300,
          xp: 10,
          magic: (plus = 0) => {
            let ep = 5 + plus;
            let em = magic.list[10];
            if (status.enemy.battle.hp < 400) {
              em = magic.list[11];
              if (status.enemy.battle.hp < 300) {
                if (Math.floor(Math.random() * 10) < 3) {
                  em = magic.list[12];
                }
                if (status.enemy.battle.hp < 200) {
                  if (Math.floor(Math.random() * 10) < 2) {
                    em = magic.list[12];
                  }
                  if (status.enemy.battle.hp < 100) {
                    if (Math.floor(Math.random() * 10) < 1) {
                      em = magic.list[13];
                    }
                  }
                }
              }
            }
            if (status.enemy.battle.mp < 50) {
              em = magic.list[14];
            }
            return [ep, em];
          },
          count: 0,
          after: () => {
            status.enemy.whiteSlime.count++;
            if (status.enemy.whiteSlime.count == 1) {
              document.getElementById("itemBuyList").querySelector("*[data-item=Oakwand]>button").disabled = false;
              document.getElementById("itemBuyList").querySelector("*[data-item=Skandashoes]>button").disabled = false;
            }
          },
          img: "../assets/svg/whiteSlime.svg",
        },
        blackSlime: {
          name: "黒スライム",
          hp: 1000,
          mp: 1000,
          xp: 20,
          magic: (plus = 0) => {
            let ep = 10 + plus;
            let em = magic.list[11];
            if (status.enemy.battle.hp < 500) {
              if (Math.floor(Math.random() * 2) < 1) {
                em = magic.list[12]
              }
            }
            if (Math.floor(Math.random() * 10) < 4) {
              em = magic.list[10];
            }
            if (Math.floor(Math.random() * 10) < 1) {
              ep += 30;
              em = magic.list[9];
            }
            return [ep, em];
          },
          count: 0,
          after: () => {
            status.enemy.blackSlime.count++;
            if (status.enemy.blackSlime.count == 1) {
              document.getElementById("itemBuyList").querySelector("*[data-item=Talisman]>button").disabled = false;
              document.getElementById("itemBuyList").querySelector("*[data-item=Charm]>button").disabled = false;
            }
            if (status.enemy.blackSlime.count == 5) {
              messageSet.achievement("すらいむ制覇");
            }
          },
          img: "../assets/svg/blackSlime.svg",
        },
      },
    };
    const item = {
      none: {
        name: "なし",
        func: () => { },
      },
      Amulet: {
        name: "お守り",
        func: () => { },
      },
      Salt: {
        name: "塩を送らず",
        func: () => {
        },
      },
      Guts: {
        name: "根性",
        func: () => { },
      },
      Schoolbag: {
        name: "ランドセル",
        func: () => { },
      },
      Oakwand: {
        name: "樫の杖",
        func: () => {
          let answer = 0;
          if (status.player.item.first == "Oakwand") {
            messageSet.action("playerの火力が5上昇！");
            answer += 5;
          }
          if (status.player.item.second == "Oakwand") {
            messageSet.action("playerの火力が5上昇！");
            answer += 5;
          }
          return answer;
        },
      },
      Skandashoes: {
        name: "韋駄天の靴",
        func: () => { },
      },
      Talisman: {
        name: "祝福のベル",
        func: () => { },
      },
      Charm: {
        name: "トリップトリック",
        func: () => {
          let answer = 0;
          if (status.player.item.first == "Charm") {
            messageSet.action("playerの運が1上昇した！");
            answer += 1;
          }
          if (status.player.item.second == "Charm") {
            messageSet.action("playerの運が1上昇した！");
            answer += 1;
          }
          return answer;
        },
      },
    };
    const magicList = [
      "木", "火", "土", "金", "水",
      "木偶", "火炎", "土壁", "金環", "水氷",
      "旋風", "炎天", "山鳴", "電石", "滴下",
    ];
    let magic = {
      list: [
        ["s", "wood"], ["s", "fire"], ["s", "earth"], ["s", "metal"], ["s", "water"],
        ["m", "wood"], ["m", "fire"], ["m", "earth"], ["m", "metal"], ["m", "water"],
        ["l", "wood"], ["l", "fire"], ["l", "earth"], ["l", "metal"], ["l", "water"],
      ],
      table: number => {
        number = deleteNotNumber(number);
        if (number >= 0, number <= 14) {
          return magic.list[number];
        } else {
          return "none";
        }
      },
      s: {
        wood: (level = 0, name = "player", luk = 0, act, acthealthy) => {
          let name2 = name == "player" ? "enemy" : "player";
          messageSet.action(status[name].battle.name + "は" + magicList[0] + "の魔法を使った。");
          action.damage(name, Math.floor(level / 3 + 4 + luk));
          status[name].battle.mp = Math.min(status[name][status[name].battle.id].mp, status[name].battle.mp + Math.floor(level / 5 + 3));
          return act;
        },
        fire: (level = 0, name = "player", luk = 0, act, acthealthy) => {
          if (status[name].battle.mp >= 2) {
            status[name].battle.mp -= 2;
            let name2 = name == "player" ? "enemy" : "player";
            messageSet.action(status[name].battle.name + "は" + magicList[1] + "の魔法を使った。");
            if (Math.floor(Math.random() * 100) < 10 + luk * 40) {
              messageSet.action("会心！" + status[name].battle.name + "の火力が2上昇！");
              level += 2;
            }
            action.damage(name, Math.floor(level / 2 + 5 + 2 * luk));
            if (Math.floor(Math.random() * 100) < 10 + luk * 40) {
              status[name2].battle.buff.burn = 3 * acthealthy;
            }
          }
          return act;
        },
        earth: (level = 0, name = "player", luk = 0, act, acthealthy) => {
          if (status[name].battle.mp >= 2) {
            status[name].battle.mp -= 2;
            let name2 = name == "player" ? "enemy" : "player";
            messageSet.action(status[name].battle.name + "は" + magicList[2] + "の魔法を使った。");
            action.damage(name, Math.floor(level / 3 + 4 + luk));
            status[name].battle.buff.defense = 1;
          }
          return act;
        },
        metal: (level = 0, name = "player", luk = 0, act, acthealthy) => {
          if (status[name].battle.mp >= 1) {
            status[name].battle.mp -= 1;
            let name2 = name == "player" ? "enemy" : "player";
            messageSet.action(status[name].battle.name + "は" + magicList[3] + "の魔法を使った。");
            action.recover(name, Math.floor(level / 3 + 4 + luk));
          }
          return act;
        },
        water: (level = 0, name = "player", luk = 0, act, acthealthy) => {
          if (status[name].battle.mp >= 3) {
            status[name].battle.mp -= 3;
            let name2 = name == "player" ? "enemy" : "player";
            messageSet.action(status[name].battle.name + "は" + magicList[4] + "の魔法を使った。");
            action.damage(name, Math.floor(level / 3 + 4 + luk));
            if (Math.floor(Math.random() * 100) < 10 + luk * 40) {
              status[name2].battle.buff.falter = 1 * acthealthy;
            }
          }
          return act;
        },
      },
      m: {
        wood: (level = 0, name = "player", luk = 0, act, acthealthy) => {
          let name2 = name == "player" ? "enemy" : "player";
          messageSet.action(status[name].battle.name + "は" + magicList[5] + "の魔法を使った。");
          let sol = (status.player.item.first == "Salt" || status.player.item.second == "Salt");
          level = level * 5 - 10 + luk * 3;
          status.player.battle.hp = Math.min(status.player.normal.hp, Math.max(status.player.battle.hp - level, 0));
          status.player.battle.mp = Math.min(status.player.normal.mp, Math.max(status.player.battle.mp - level, 0));
          if (!(level < 0 && sol)) {
            status.enemy.battle.hp = Math.min(status.enemy[status.enemy.battle.id].hp, Math.max(status.enemy.battle.hp - level, 0));
            status.enemy.battle.mp = Math.min(status.enemy[status.enemy.battle.id].mp, Math.max(status.enemy.battle.mp - level, 0));
          };
          return act;
        },
        fire: (level = 0, name = "player", luk = 0, act, acthealthy) => {
          if (status[name].battle.mp >= 4) {
            status[name].battle.mp -= 4;
            let name2 = name == "player" ? "enemy" : "player";
            messageSet.action(status[name].battle.name + "は" + magicList[6] + "の魔法を使った。");
            for (let i = 0; i < 2; i++) {
              if (Math.floor(Math.random() * 100) < 10 + luk * 40) {
                messageSet.action("会心！" + status[name].battle.name + "の火力が2上昇！");
                level += 2;
              }
              action.damage(name, Math.floor(level / 2 + 5 + 2 * luk));
              if (Math.floor(Math.random() * 100) < 10 + luk * 40) {
                status[name2].battle.buff.burn = 3 * acthealthy;
              }
            }
          }
          return act;
        },
        earth: (level = 0, name = "player", luk = 0, act, acthealthy) => {
          if (status[name].battle.mp >= 4) {
            status[name].battle.mp -= 4;
            let name2 = name == "player" ? "enemy" : "player";
            messageSet.action(status[name].battle.name + "は" + magicList[7] + "の魔法を使った。");
            status[name].battle.buff.parry = 1;
          }
          return act;
        },
        metal: (level = 0, name = "player", luk = 0, act, acthealthy) => {
          if (status[name].battle.mp >= 3) {
            status[name].battle.mp -= 3;
            let name2 = name == "player" ? "enemy" : "player";
            messageSet.action(status[name].battle.name + "は" + magicList[8] + "の魔法を使った。");
            action.recover(name, Math.floor(level / 2 + 5 + 2 * luk));
            status[name].battle.buff.burn = 0;
            status[name].battle.buff.falter = 0;
            status[name].battle.buff.curse = 0;
            status[name].battle.buff.unhealthy = 0;
          }
          return act;
        },
        water: (level = 0, name = "player", luk = 0, act, acthealthy) => {
          if (status[name].battle.mp >= 9) {
            status[name].battle.mp -= 9;
            let name2 = name == "player" ? "enemy" : "player";
            messageSet.action(status[name].battle.name + "は" + magicList[9] + "の魔法を使った。");
            status[name2].battle.buff.curse = Math.floor((level + 10) / 3 + 1) * acthealthy;
          }
          return act;
        },
      },
      l: {
        wood: (level = 0, name = "player", luk = 0, act, acthealthy) => {
          if (status[name].battle.mp >= 1) {
            status[name].battle.mp -= 1;
            let name2 = name == "player" ? "enemy" : "player";
            messageSet.action(status[name].battle.name + "は" + magicList[10] + "の魔法を使った。");
            if (Math.floor(Math.random() * 100) < 10 + luk * 40) {
              messageSet.action("会心！" + status[name].battle.name + "の火力が2上昇！");
              level += 2;
            }
            action.damage(name, Math.floor(level / 3 + 4 + luk));
            if (Math.floor(Math.random() * 100) < 10 + luk * 40) {
              messageSet.action("さらに追撃！");
              if (name == "player") {
                act = action.end;
              } else {
                act = action.enemy;
              }
            }
            if (Math.floor(Math.random() * 100) < 50 + luk * 20) {
              action.recover(name, Math.floor(level / 2 + 5 + 2 * luk));
            }
            if (Math.floor(Math.random() * 100) < 50 + luk * 20) {
              action.recovermp(name, Math.floor(level / 2 + 5 + 2 * luk));
            }
          }
          return act;
        },
        fire: (level = 0, name = "player", luk = 0, act, acthealthy) => {
          if (status[name].battle.mp >= 10) {
            status[name].battle.mp -= 10;
            let name2 = name == "player" ? "enemy" : "player";
            messageSet.action(status[name].battle.name + "は" + magicList[11] + "の魔法を使った。");
            for (let i = 0; i < 3; i++) {
              messageSet.action("会心！" + status[name].battle.name + "の火力が2上昇！");
              level += 2;
              action.damage(name, Math.floor(2 * level / 3 + 7 + 2 * luk));
              if (Math.floor(Math.random() * 100) < 10 + luk * 40) {
                status[name2].battle.buff.burn = 3 * acthealthy;
              }
              if (Math.floor(Math.random() * 100) < 50 + luk * 20) {
                action.recovermp(name, Math.floor(level / 2 + 5 + 2 * luk));
              }
            }
            status[name].battle.buff.boost = 2;
          }
          return act;
        },
        earth: (level = 0, name = "player", luk = 0, act, acthealthy) => {
          if (status[name].battle.mp >= 10) {
            status[name].battle.mp -= 10;
            let name2 = name == "player" ? "enemy" : "player";
            messageSet.action(status[name].battle.name + "は" + magicList[12] + "の魔法を使った。");
            status[name].battle.buff.Sdefense = 1;
            status[name].battle.buff.healthy = 1;
            if (Math.floor(Math.random() * 100) < 50 + luk * 20) {
              action.recover(name, Math.floor(level / 2 + 5 + 2 * luk));
            }
          }
          return act;
        },
        metal: (level = 0, name = "player", luk = 0, act, acthealthy) => {
          if (status[name].battle.mp >= 7) {
            status[name].battle.mp -= 7;
            let name2 = name == "player" ? "enemy" : "player";
            messageSet.action(status[name].battle.name + "は" + magicList[13] + "の魔法を使った。");
            action.recover(name, status[name][status[name].battle.id].hp / 2);
            status[name].battle.buff.burn = 0;
            status[name].battle.buff.falter = 0;
            status[name].battle.buff.curse = 0;
            status[name].battle.buff.unhealthy = 0;
            status[name].battle.buff.healthy = 1;
            status[name].battle.buff.counter = 1;
          }
          return act;
        },
        water: (level = 0, name = "player", luk = 0, act, acthealthy) => {
          if (status[name].battle.hp >= 10) {
            status[name].battle.hp -= 10;
            let name2 = name == "player" ? "enemy" : "player";
            messageSet.action(status[name].battle.name + "は" + magicList[14] + "の魔法を使った。");
            if (Math.floor(Math.random() * 100) < 10 + luk * 40) {
              messageSet.action("会心！" + status[name].battle.name + "の火力が2上昇！");
              level += 2;
            }
            action.recovermp(name, Math.floor(action.damage(name, Math.floor(2 * level / 3 + 7 + 2 * luk)) / 2));
            status[name].battle.buff.unhealthy = 1 * acthealthy;
          }
          return act;
        },
      },
    };
    const buff = {
      burn: () => {
        let answer = 0;
        answer = 5;
        return answer;
      }, //やけど
      defense: 0, //防御
      falter: () => {
        let answer = 0;
        answer = -2;
        return answer;
      }, //怯み
      parry: 0, //受け流し
      curse: (name) => {
        let answer = 0;
        answer = Math.floor(status[name].battle.hp * 0.2);
        return answer;
      }, //呪い
      boost: () => {
        let answer = 0;
        answer = 2;
        return answer;
      }, //増強
      Sdefense: 0, //超防御
      healthy: () => {
        let answer = 0;
        answer = -1;
        return answer;
      }, //状態異常効かない
      counter: 0, //反撃
      unhealthy: () => {
        let answer = 0;
        answer = 1;
        return answer;
      }, //状態異常効きやすい
    };


    // Game
    let savedata = userID;
    let setMagic1 = 0;
    let setMagic2 = 1;
    let Point = 0;
    let position = 0;
    let armorNumber = 0;
    let learnPoint = 30;
    let bestPositionNumber = 0;
    let turn = 0;
    const magicList1 = document.querySelectorAll("[name='magic1']");
    const magicList2 = document.querySelectorAll("[name='magic2']");
    const nowPoint = document.getElementsByClassName("nowPoint");
    const nowPosition = document.getElementsByClassName("nowPosition");
    const sideSelectMagic = document.getElementsByClassName("sideSelectMagic")[0];
    const armorSelect = document.getElementById("armorSelect");
    const armorList = document.getElementById("armorList");
    const armorListChildren = document.getElementById("armorList").children;
    const bestPosition = document.getElementsByClassName("bestPosition");
    const menu1 = document.getElementsByClassName("menu1");

    const menu = (element) => {
      pageChange(element.value);
    };
    const pageChange = (page = "mainPage") => {
      let flag = true;
      for (const i of document.querySelector("main").children) {
        if (i.id == page) {
          i.removeAttribute("style");
          flag = false;
        } else {
          i.setAttribute("style", "display: none;");
        }
      }
      if (flag) {
        document.getElementById("mainPage").removeAttribute("style");
      }
    };
    const start = element => {
      messageSet.achievement("スタート");
      for (let i = 1; i < document.getElementById("mainPage").children[0].children.length; i++) {
        document.getElementById("mainPage").children[0].children[i].classList.add("none");
      }
      elementFadeOut(element, (element, answer, time, clone, n) => {
        // start(element.insertAdjacentElement("afterend", clone));
        element.remove();
        messageSay("ようこそ");
        for (const i of menu1) {
          i.classList.remove("none");
          messageSet.announce.menu(i.innerText);
        }
        document.getElementById("start").removeAttribute("style");
        fadeInOnce(document.getElementById("start"));
      });
      element.removeAttribute('onclick');
      element.classList.add("fadeOut");
    };
    const userIDset = element => {
      if (element.value.length == 8) {
        userIDchange(element.value);
      } else {
        element.value = userID;
      }
    };
    const setMagicChange = element => {
      if (element.name == "magic1") {
        setMagic1 = Array.prototype.slice.call(magicList1).indexOf(element);
        for (const i of selectMagic1) {
          i.innerText = magicList[setMagic1];
        }
      } else {
        setMagic2 = Array.prototype.slice.call(magicList2).indexOf(element);
        for (const i of selectMagic2) {
          i.innerText = magicList[setMagic2];
        }
      }
    };
    const pointChange = (number = 0) => {
      for (const i of nowPoint) {
        i.innerText = point = number;
      }
    };
    const magicPointChangeSub = (number = 0, element) => {
      let num = Array.prototype.slice.call(magicQuery).indexOf(element.parentElement);
      magicPointChange(number, num);
    }
    const magicPointChange = (number, num) => {
      let poi = magicPoint[num] + number;
      if (number < 0) {
        let j = 0;
        for (const i of magicPoint) {
          if (i < 0) {
            j += i;
          }
        }
        if (j <= -20 && poi < 0) {
          return;
        }
      }
      if (poi >= -10 && poi <= 5) {
        if (point >= number) {
          pointChange(point - number);
          magicPoint[num] += number;
          magicQuery[num].querySelector("label+label+span+button+span").innerText = magicPoint[num];
        }
      }
    };
    const learn = () => {
      if (learnedMagicListPageLength <= 3 && point >= learnPoint) {
        pointChange(point - learnPoint);
        learnPoint += 70;
        if (bestPositionNumber < 10) {
          document.getElementById("unlearnedMagicList").querySelector("div>button").disabled = true;
        }
        document.getElementById("unlearnedMagicList").querySelector("div>span").innerText = learnPoint + " 10階に到達する";
        learnedMagicListPageLength++;
        messageSay("魔法を購入しました。");
        if (learnedMagicListPageLength == 3) {
          messageSet.achievement("魔法大全");
          document.getElementById("unlearnedMagicList").innerHTML = "全て習得した";
        }
      } else {
        messageSay("ポイントが足りません。", false);
      }
    };
    const positionChange = (number = 0) => {
      position = number;
      for (const i of nowPosition) {
        i.innerText = number;
      }
      for (const i of bestPosition) {
        i.innerText = bestPositionNumber;
        if (learnedMagicListPageLength < 2 && bestPositionNumber >= 5) {
          document.getElementById("unlearnedMagicList").querySelector("div>button").disabled = false;
        }
        if (learnedMagicListPageLength < 3 && bestPositionNumber >= 10) {
          document.getElementById("unlearnedMagicList").querySelector("div>button").disabled = false;
        }
      }
      area();
      return position;
    };
    const goBack = (number = 1) => {
      let num = position + number;
      let pos = Math.max(num, 0);
      if (number > 0) {
        if (gameMath.random(2) == 0 || position == 0) {
          bestPositionNumber = Math.max(pos, bestPositionNumber);
          positionChange(pos);
        } else {
          positionChange(position);
        }
        goBackButton.classList.add("none");
        goBackButton.classList.remove("fadeIn");
        goBackPosition.classList.remove("none");
        goBackPosition.classList.add("fadeIn");
        for (const i of menu1) {
          i.disabled = true;
        }
        action.start();
      } else {
        if (position != 0) {
          if (pos == 0) {
            messageSay(status.player.battle.name + "は帰った");
            for (const i in status.player.battle.buff) {
              status.player.battle.buff[i] = 0;
            }
          }
          positionChange(pos);
        }
      }
      actionResult.textContent = "";
      return position;
    };
    const goBackMenu = () => {
      goBackButton.classList.remove("none");
      goBackButton.classList.add("fadeIn");
      goBackPosition.classList.add("none");
      goBackPosition.classList.remove("fadeIn");
      for (const i of menu1) {
        i.disabled = false;
      }
    };
    const setStatus = {
      element: {
        player: {
          name: document.getElementById("player").children[0].children[0].children[0],
          hp: document.getElementById("player").children[0].children[1].children[0],
          mp: document.getElementById("player").children[0].children[2].children[0],
        },
        enemy: {
          name: document.getElementById("enemy").children[0].children[0].children[0],
          hp: document.getElementById("enemy").children[0].children[1].children[0],
          mp: document.getElementById("enemy").children[0].children[2].children[0],
        },
      },
      player: () => {
        setStatus.element.player.name.innerText = status.player.battle.name;
        setStatus.element.player.hp.innerText = status.player.battle.hp;
        setStatus.element.player.mp.innerText = status.player.battle.mp;
      },
      enemy: () => {
        setStatus.element.enemy.name.innerText = status.enemy.battle.name;
        setStatus.element.enemy.hp.innerText = status.enemy.battle.hp;
        setStatus.element.enemy.mp.innerText = status.enemy.battle.mp;
      },
    };
    const area = (number = position) => {
      let name = "blueSlime";
      let random = gameMath.random();
      if (number == 0) {
        status.player.battle.hp = status.player.normal.hp;
        status.player.battle.mp = status.player.normal.mp;
        name = "none";
      } else if (number < 4) {
        name = "blueSlime";
      } else if (number < 10) {
        name = "redSlime";
      } else if (number < 13) {
        name = "yellowSlime";
      } else if (number < 20) {
        name = "whiteSlime";
      } else {
        name = "blackSlime";
      }
      if (name != "none") {
        enemyImg.src = status.enemy[name].img;
      }
      status.enemy.battle.id = name;
      status.enemy.battle.name = status.enemy[name].name;
      status.enemy.battle.hp = status.enemy[name].hp;
      status.enemy.battle.mp = status.enemy[name].mp;
      for (const i in status.enemy.battle.buff) {
        status.enemy.battle.buff[i] = 0;
      }
    };
    const armorListChange = (number = 0) => {
      if (number == 1 || number == 2) {
        armorNumber = number;
        let num = armorNumber == 1 ? "first" : "second";
        if (status.player.item[num] != "none") {
          status.player.item.has[status.player.item[num]]++;
        }
        status.player.item[num] == "none";
        for (const i of armorListChildren) {
          if (status.player.item.has[i.dataset.item] > 0) {
            i.classList.remove("none");
          } else {
            i.classList.add("none");
          }
        }
        armorSelect.classList.add("none");
        armorList.classList.remove("none");
      }
    };
    const armorChange = element => {
      let num = armorNumber == 1 ? "first" : "second";
      let name = element.parentElement.dataset.item;
      itemChange(num, name)
      armorSelect.classList.remove("none");
      armorList.classList.add("none");
    };
    const itemChange = (num, name) => {
      if (name != "none") {
        status.player.item.has[name]--;
      }
      status.player.item[num] = name;
      for (const i of selectItem1) {
        i.innerText = item[status.player.item.first].name;
      }
      for (const i of selectItem2) {
        i.innerText = item[status.player.item.second].name;
      }
    };
    const itemBuyList = document.getElementById("itemBuyList").querySelectorAll("*[data-item]>span");
    const itemCount = () => {
      for (const i of itemBuyList) {
        let item = i.parentElement.dataset.item;
        i.innerText = status.player.item.all[item];
      }
    };
    const armorBuy = element => {
      let item = element.parentElement.dataset.item;
      if (status.player.item.all[item] < 2) {
        let num = 5;
        switch (item) {
          case "Amulet":
          case "Salt":
            num = 5;
            break;
          case "Guts":
          case "Schoolbag":
            num = 10;
            break;
          case "Oakwand":
          case "Skandashoes":
            num = 15;
            break;
          case "Talisman":
          case "Charm":
            num = 20;
            break;
        }
        if (point >= num) {
          pointChange(point - num);
          messageSay(item + "を購入しました。")
          if (++status.player.item.all[item] > 1) {
            element.disabled = true;
            let count = true;
            for (const i in status.player.item.all) {
              if (!(status.player.item.all[i] >= 2)) {
                count = false;
                break;
              }
            }
            if (count) {
              messageSet.achievement("収集家");
              messageSet.point(5);
              pointChange(point + 5);
            }
          }
          ++status.player.item.has[item];
          itemCount();
        } else {
          messageSay("ポイントが足りません。", false);
        }
      }
    };
    const randomLuck = number => gameMath.random(number * luk);

    // 最後に実行
    pageChange();
    pointChange();
    setStatus.player();
    setStatus.enemy();
    itemCount();

    // action
    let luk = 1;
    const onMagic = () => {
      let num = 0;
      for (let i = 0; i < sideSelectMagic.children.length; i++) {
        if (sideSelectMagic.children[i].children[0].children[1].checked) {
          num = i;
          break;
        }
      };
      let name;
      if (num == 0) {
        name = magic.table(setMagic1);
        mapo = magicPoint[setMagic1];
      } else {
        name = magic.table(setMagic2);
        mapo = magicPoint[setMagic2];
      }
      action.act(name, mapo);
    };
    const action = {
      obj: (maginame = "none", magipoint = "none") => {
        return {
          name: maginame,
          point: magipoint,
        };
      },
      start: () => {
        setStatus.player();
        setStatus.enemy();
        turn = 0;
      },
      end: () => {
        turn++;
        messageSet.action(turn);
        if (status.enemy.battle.hp <= 0) {
          messageSay(status.enemy.battle.name + "は帰った");
          pointChange(point + status.enemy[status.enemy.battle.id].xp);
          status.enemy[status.enemy.battle.id].after();
          messageSet.point(status.enemy[status.enemy.battle.id].xp);
          goBackMenu();
        }
        if (status.player.battle.hp <= 0) {
          messageSay("ちょっと無理かも……");
          goBackMenu();
          goBack(-position);
        }
      },
      cal: (time = -1, name) => {
        let answer = 0;
        switch (time) {
          case 0: //level
            if (status[name].battle.buff.boost > 0) {
              messageSet.action(status[name].battle.name + "の火力が2上昇！");
              answer += buff.boost();
            }
            if (status[name].battle.buff.falter > 0) {
              messageSet.action(status[name].battle.name + "の火力が2減少。");
              answer += buff.falter();
            }
            if (name == "player") {
              answer += item.Oakwand.func();
            }
            if (answer > 0) {
              messageSet.action(status[name].battle.name + "の火力は合計で" + answer + "上昇した！");
            } else if (answer < 0) {
              messageSet.action(status[name].battle.name + "の火力は合計で" + answer + "減少した！");
            }
            break;
          case 1: //luk
            answer += item.Charm.func();
            break;
          case 2: //amulet defense Sdefense parry counter
            break;
          case 3: //guts talisman
            break;
          case 4: //healthy unhealthy
            answer = 1;
            if (status[name].battle.buff.healthy > 0) {
              messageSet.action(status[name].battle.name + "は状態異常にかかりにくくなった！");
              answer += buff.healthy();
            }
            if (status[name].battle.buff.unhealthy > 0) {
              messageSet.action(status[name].battle.name + "は状態異常にかかりやすくなった。");
              answer += buff.unhealthy();
            }
            break;
          case 5: //burn curse
            if (status[name].battle.buff.burn > 0) {
              messageSet.action(status[name].battle.name + "はやけどだ。");
              answer += buff.burn();
            }
            if (status[name].battle.buff.curse > 0) {
              messageSet.action(status[name].battle.name + "は呪われている。");
              answer += buff.curse(name);
            }
            break;
        }
        return answer;
      },
      act: (actName, actPoint) => {
        let act = action.enemy;
        act = action.player(actName, actPoint, luk, act);
        act(actName, actPoint, luk, action.end);
      },
      damage: (name, value = 0, buff = "none") => {
        if (!(value < 0 && (status.player.item.first == "Salt" || status.player.item.second == "Salt"))) {
          if (name == "player") {
            if (status.enemy.battle.buff.defense > 0) {
              messageSet.action(status.enemy.battle.name + "は防御した！");
              value = Math.floor(value * 0.8);
            }
            if (status.enemy.battle.buff.Sdefense > 0) {
              messageSet.action(status.enemy.battle.name + "は超防御した！");
              value = Math.floor(value * 0.1);
            }
            if (status.enemy.battle.buff.parry > 0 && buff == "none") {
              messageSet.action(status.enemy.battle.name + "は跳ね返した！");
              action.damage("enemy", value * 2, "parry");
              value = Math.floor(value * 0.5);
            }
            if (status.enemy.battle.buff.counter > 0 && buff == "none") {
              messageSet.action(status.enemy.battle.name + "はカウンターをした！");
              action.damage("enemy", Math.floor(value * 0.5), "counter");
              value = Math.floor(value * 0.6);
            }
            let answer = Math.max(status.enemy.battle.hp - value, 0);
            let xxx = status.enemy.battle.hp - answer;
            status.enemy.battle.hp = answer;
            messageSet.action(status.enemy.battle.name + "のHPは" + xxx + "減った！");
            return xxx;
          } else if (name == "enemy") {
            if (status.player.battle.buff.defense > 0) {
              messageSet.action(status.player.battle.name + "は防御した！");
              value = Math.floor(value * 0.8);
            }
            if (status.player.battle.buff.Sdefense > 0) {
              messageSet.action(status.player.battle.name + "は超防御した！");
              value = Math.floor(value * 0.1);
            }
            if (status.player.battle.buff.parry > 0 && buff == "none") {
              messageSet.action(status.player.battle.name + "は跳ね返した！");
              action.damage("player", value * 2, "parry");
            }
            if (status.player.battle.buff.counter > 0 && buff == "none") {
              messageSet.action(status.player.battle.name + "はカウンターをした！");
              action.damage("player", Math.floor(value * 0.5), "counter");
              value = Math.floor(value * 0.3);
            }
            let amu = 0;
            if (status.player.item.first == "Amulet") {
              messageSet.action(status.player.battle.name + "のお守りが発動！");
              amu += 3;
            }
            if (status.player.item.second == "Amulet") {
              messageSet.action(status.player.battle.name + "のお守りが発動！");
              amu += 3;
            }
            let hphphp = (status.player.battle.hp >= status.player.normal.hp * 0.2);
            let answer = Math.min(status.player.normal.hp, Math.max(status.player.battle.hp - Math.max(value - amu, 1), 0));
            if (answer == 0) {
              if (hphphp && (status.player.item.first == "Guts" || status.player.item.second == "Guts")) {
                messageSet.action(status.player.battle.name + "の根性が発動！");
                answer = 1;
              } else {
                if (status.player.item.first == "Talisman" || status.player.item.second == "Talisman") {
                  if (status.player.item.first == "Talisman" && status.player.item.second == "Talisman") {
                    if (Math.floor(Math.random() * 100) < 70 + luk * 20) {
                      messageSet.action(status.player.battle.name + "の祝福のベルが発動！");
                      action.recover("player", status.player.normal.hp);
                      action.recovermp("player", status.player.normal.mp);
                      answer = status.player.normal.hp;
                    }
                  } else {
                    if (Math.floor(Math.random() * 100) < 30 + luk * 20) {
                      messageSet.action(status.player.battle.name + "の祝福のベルが発動！");
                      action.recover("player", status.player.normal.hp);
                      action.recovermp("player", status.player.normal.mp);
                      answer = status.player.normal.hp;
                    }
                  }
                }
              }
            }
            let xxx = status.player.battle.hp - answer;
            status.player.battle.hp = answer;
            messageSet.action(status.player.battle.name + "のHPは" + xxx + "減った！");
            return xxx;
          }
        }
      },
      recover: (name, value = 0, buff = "none") => {
        messageSet.action(status[name].battle.name + "のHPは" + (Math.min(status[name].battle.hp + value, status[name][status[name].battle.id].hp) - status[name].battle.hp) + "増えた！");
        status[name].battle.hp = Math.min(status[name].battle.hp + value, status[name][status[name].battle.id].hp);
      },
      recovermp: (name, value = 0, buff = "none") => {
        messageSet.action(status[name].battle.name + "のMPは" + (Math.min(status[name].battle.mp + value, status[name][status[name].battle.id].mp) - status[name].battle.mp) + "増えた！");
        status[name].battle.mp = Math.min(status[name].battle.mp + value, status[name][status[name].battle.id].mp);
      },
      player: (actName, actPoint, luk, act) => {
        actPoint += action.cal(0, "player");
        let acthealthy = action.cal(4, "enemy");
        luk = action.cal(1);
        let answer = magic[actName[0]][actName[1]](actPoint, "player", luk, act, acthealthy);
        if (status.player.item.first == "Schoolbag") {
          messageSet.action(status.player.battle.name + "のランドセルが発動！");
          action.recover("player", 5);
          action.recovermp("player", 5);
        }
        let xxx = action.cal(5, "player");
        if (xxx != 0) action.damage("enemy", xxx);
        if (status.player.item.second == "Schoolbag") {
          messageSet.action(status.player.battle.name + "のランドセルが発動！");
          action.recover("player", 5);
          action.recovermp("player", 5);
        }
        if (status.player.item.first == "Skandashoes" && (Math.floor(Math.random() * 100) < 60 + luk * 14)) {
          messageSet.action(status.player.battle.name + "の韋駄天の靴が発動！");
          messageSet.action("さらに追撃！");
          answer = action.end;
        } else {
          if (status.player.item.second == "Skandashoes" && (Math.floor(Math.random() * 100) < 60 + luk * 14)) {
            messageSet.action(status.player.battle.name + "の韋駄天の靴が発動！");
            messageSet.action("さらに追撃！");
            answer = action.end;
          }
        }
        status.player.battle.buff.burn = Math.max(status.player.battle.buff.burn - 1, 0);
        status.player.battle.buff.falter = Math.max(status.player.battle.buff.falter - 1, 0);
        status.player.battle.buff.curse = Math.max(status.player.battle.buff.curse - 1, 0);
        status.player.battle.buff.boost = Math.max(status.player.battle.buff.boost - 1, 0);
        status.enemy.battle.buff.defense = Math.max(status.enemy.battle.buff.defense - 1, 0);
        status.enemy.battle.buff.parry = Math.max(status.enemy.battle.buff.parry - 1, 0);
        status.enemy.battle.buff.Sdefense = Math.max(status.enemy.battle.buff.Sdefense - 1, 0);
        status.enemy.battle.buff.healthy = Math.max(status.enemy.battle.buff.healthy - 1, 0);
        status.enemy.battle.buff.unhealthy = Math.max(status.enemy.battle.buff.unhealthy - 1, 0);
        status.enemy.battle.buff.counter = Math.max(status.enemy.battle.buff.counter - 1, 0);
        if (status.player.battle.hp <= 0) {
          answer = action.end;
        }
        setStatus.player();
        setStatus.enemy();
        return answer;
      },
      enemy: (actName, actPoint, luk, act) => {
        [actPoint, actName] = status.enemy[status.enemy.battle.id].magic(action.cal(0, "enemy"));
        let acthealthy = action.cal(4, "player");
        let answer = magic[actName[0]][actName[1]](actPoint, "enemy", luk, act, acthealthy);
        let xxx = action.cal(5, "enemy");
        if (xxx != 0) action.damage("player", xxx);
        status.enemy.battle.buff.burn = Math.max(status.enemy.battle.buff.burn - 1, 0);
        status.enemy.battle.buff.falter = Math.max(status.enemy.battle.buff.falter - 1, 0);
        status.enemy.battle.buff.curse = Math.max(status.enemy.battle.buff.curse - 1, 0);
        status.enemy.battle.buff.boost = Math.max(status.enemy.battle.buff.boost - 1, 0);
        status.player.battle.buff.defense = Math.max(status.player.battle.buff.defense - 1, 0);
        status.player.battle.buff.parry = Math.max(status.player.battle.buff.parry - 1, 0);
        status.player.battle.buff.Sdefense = Math.max(status.player.battle.buff.Sdefense - 1, 0);
        status.player.battle.buff.healthy = Math.max(status.player.battle.buff.healthy - 1, 0);
        status.player.battle.buff.unhealthy = Math.max(status.player.battle.buff.unhealthy - 1, 0);
        status.player.battle.buff.counter = Math.max(status.player.battle.buff.counter - 1, 0);
        if (status.player.battle.hp <= 0) {
          answer = action.end;
        }
        setStatus.player();
        setStatus.enemy();
        answer(actName, actPoint, luk, act);
      },
    };

    const save = () => {
      savedata = [
        userID,
        point,
        bestPositionNumber,
        status.enemy.blueSlime.count,
        status.enemy.redSlime.count,
        status.enemy.yellowSlime.count,
        status.enemy.whiteSlime.count,
        status.enemy.blackSlime.count,
        status.player.item.all.Amulet,
        status.player.item.all.Salt,
        status.player.item.all.Guts,
        status.player.item.all.Schoolbag,
        status.player.item.all.Oakwand,
        status.player.item.all.Skandashoes,
        status.player.item.all.Talisman,
        status.player.item.all.Charm,
        status.player.item.first,
        status.player.item.second,
        learnedMagicListPageLength,
        magicPoint
      ];
      savedata = btoa(savedata);
    };
    const load = (value) => {
      value = atob(value);
      value = value.split(",");
      for (let i = 1; i < value.length; i++) {
        if (!isNaN(value[i])) {
          value[i] = parseInt(value[i]);
        }
      }
      userIDchange(value[0], false);
      document.querySelector("#userIDinput").value = 0;
      userIDset(document.querySelector("#userIDinput"));
      point += value[1];
      bestPositionNumber = value[2];
      positionChange(0);
      for (let i = 0; i < value[3]; i++) {
        status.enemy.blueSlime.after();
      }
      for (let i = 0; i < value[4]; i++) {
        status.enemy.redSlime.after();
      }
      for (let i = 0; i < value[5]; i++) {
        status.enemy.yellowSlime.after();
      }
      for (let i = 0; i < value[6]; i++) {
        status.enemy.whiteSlime.after();
      }
      for (let i = 0; i < value[7]; i++) {
        status.enemy.blackSlime.after();
      }
      const itemList = document.querySelectorAll("#itemBuyList button");
      let number = 0;
      if (value[8] > 1) {
        number++;
        point += 5;
        armorBuy(itemList[0]);
      }
      for (let i = 1; i < 8; i++) {
        for (let j = 0; j < value[8 + i]; j++) {
          number++;
          point += Math.floor(i / 2 + 1) * 5;
          armorBuy(itemList[i]);
        }
      }
      if (number >= 15) {
        point -= 5;
      }
      itemChange("first", value[16]);
      itemChange("second", value[17]);
      if (value[18] > 1) {
        point += 30;
        learn();
      }
      if (value[18] > 2) {
        point += 100;
        learn();
      }
      for (let i = 0; i < 15; i++) {
        point += value[19 + i];
        magicPointChange(value[19 + i], i)
      }
      pointChange(point);
    };




    // おまけ
    const LookAndSay = (number, reverse = false, numberOnly = false) => {
      let regex = /(.)\1*/g;
      if (numberOnly) {
        regex = /(\d)\1*/g;
      }
      try {
        number = number.toString();
      } catch (e) {
        number = "1";
      }
      return number.replace(regex, (num1, num2) => {
        let len = num1.length.toString();
        let num = num2;
        if (reverse) {
          [num, len] = [len, num];
        }
        return num + len;
      })
    };
    const deleteNotNumber = (text = "", string = false, NaNzero = true) => {
      text = text.toString().replaceAll(/[^.\d]/g, "");
      if (NaNzero && text === "") {
        text = 0;
      }
      if (string) {
        return text.toString();
      } else {
        return parseFloat(text);
      }
    };

    const sequence = {
      two: number => cal("(1+p(-1,n))/2", parseInt(deleteNotNumber(number))),
      // return (1 + (-1) ** n) / 2;
      // (-1)**9007199254740991
      three: number => cal("(1+p(-1,p((1+s(5))/2,n)/s(5)-p((1-s(5))/2,n)/s(5)))/2", parseInt(deleteNotNumber(number))),
      // return (1 + gameMath.exponentiation(-1, ((1 + Math.sqrt(5)) ** n + (1 - Math.sqrt(5)) ** n) / 2 ** n)) / 2;,
      // for(let i=0;i<100;i++){if(sequence.three(i)!=(i%3==0?1:0)){console.log(i);break;}}
      four: number => cal("(1+p(-1,n))*(1+p(-1,n/2+(1-p(-1,n))/4))/4", parseInt(deleteNotNumber(number))),
    };
    const sequenceSub = {
      check: (number = 2) => {
        let func = () => 0;
        switch (number) {
          case 2:
            func = sequence.two;
            break;
          case 3:
            func = sequence.three;
            break;
          case 4:
            func = sequence.four;
            break;
        }
        for (let i = 0; i < 100; i++) {
          if (func(i) != (i % number == 0 ? 1 : 0)) {
            return i;
          }
        }
        return "over 100";
      },
      checkAll: () => {
        let answer = {};
        for (let i = 2; i <= 4; i++) {
          answer[i] = sequence.check(i);
        }
        return answer;
      },
    };
    const gameMath = {
      // main
      random: (number = 10) => {
        return Math.floor(Math.random() * deleteNotNumber(number));
      },
      // sub
      replace: (equation = "") => {
        equation = equation.replaceAll("０", "0");
        equation = equation.replaceAll("１", "1");
        equation = equation.replaceAll("２", "2");
        equation = equation.replaceAll("３", "3");
        equation = equation.replaceAll("４", "4");
        equation = equation.replaceAll("５", "5");
        equation = equation.replaceAll("６", "6");
        equation = equation.replaceAll("７", "7");
        equation = equation.replaceAll("８", "8");
        equation = equation.replaceAll("９", "9");
        equation = equation.replaceAll(/\s/g, "");
        equation = equation.replaceAll(/＋/g, "+");
        equation = equation.replaceAll(/－/g, "-");
        equation = equation.replaceAll(/×/g, "*");
        equation = equation.replaceAll(/÷/g, "/");
        equation = equation.replaceAll(/[\{\[（｛［]/g, "(");
        equation = equation.replaceAll(/[\]\}）｝］]/g, ")");
        equation = equation.replaceAll(/[NｎＮ]/g, "n");
        equation = equation.replaceAll(/[PｐＰ]/g, "p");
        equation = equation.replaceAll(/[√SｓＳ]/g, "s");
        equation = equation.replaceAll(/[^,\d\+\-*\/\.\(\)nps]/g, "");
        equation = equation.replaceAll("p", "gameMath.exponentiation");
        equation = equation.replaceAll("s", "Math.sqrt");
        return equation;
      },
      exponentiation: (base = 0, exponent = 0) => {
        let power = base;
        if (Math.abs(exponent - Math.round(exponent)) <= exponent * Math.pow(10, -5)) {
          power = Math.pow(base, Math.round(exponent));
        }
        return power;
      },
      square: (radicand) => {
      },
      calculate: (equation = "", n = 0) => new Function("let n = " + n + "; return" + equation)(),
      digits: (number) => {
        if (Number.isFinite(number)) {
          let array = number.toString().split(".");
          number = 0;
          array.push("");
          array.forEach(element => number += element.length);
          return number;
          // let array = [number.toString().split(".")];
          // array[0].push("");
          // if (array[0][0] == 0) {
          //   array[0][0] = "";
          // }
          // array[1] = 0;
          // array[0].forEach(element => array[1] += element.length);
          // return [array[1], array[0][0].length, array[0][1].length];
        } else {
          return 0;
        }
      },
      check: {
        cycle: func => {
          let answer = "";
          for (let i = 1; i <= 60; i++) {
            answer += func(i);
          }
          if (answer.length == 60 && answer.replaceAll("1", "") == "") {
            answer = "one";
          } else {
            answer = (answer.match(/0+?1/g) || []).length;
          }
          answer = answer == 30 || answer == 29 ? "two" : answer == 20 || answer == 19 ? "three" : answer == 15 || answer == 14 ? "four" : answer == 12 || answer == 11 ? "five" : answer == 10 || answer == 9 ? "six" : answer == "one" ? "one" : "none";
          return answer;
          // gameMath.check.cycle((n)=>cal("(1+p(-1,n))/2",n))
          // for (const i in sequence) console.log(gameMath.check.cycle((n)=>sequence[i](n)))
          // for(let i = 1; i <= 6; i++) console.log(gameMath.check.cycle((n)=>n%i==0?1:0))
        },
      },
    };
    const cal = (text = "", i = 0) => gameMath.calculate(gameMath.replace(text), i);

    (() => {
      let a = [];
      for (let i = 1; i <= 10; i++) {
        let b = [];
        for (let j = 1; j <= 100; j++) {
          b.push(j % i == 0 ? 1 : 0);
        }
        a.push(b)
      }
      return a;
    })

    // onload
    const getParam = (name, url = location.search) => {
      name = name.replace(/[\[\]]/g, "\\$&");
      let regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)", "g");
      let results = [...url.matchAll(regex)][0];
      console.log(results);
      if (!results) return "none";
      if (!results[2]) return "none";
      return decodeURIComponent(results[2].replace(/\+/g, " "));
    };
    window.addEventListener("load", () => {
      let data = getParam("d");
      console.log(data);
      if (data != "none") {
        let ldt = document.getElementById("loaddataTextarea");
        ldt.value = data;
        ldt.parentElement.previousElementSibling.children[0].click();
      }
    });
  </script>
</body>

</html>